"/*\n * Copyright 2021-2022 ForgeRock AS. All Rights Reserved\n *\n * Use of this code requires a commercial software license with ForgeRock AS.\n * or with one of its affiliates. All use shall be exclusively subject\n * to such license between the licensee and ForgeRock AS.\n *\n * In some common default configurations, the following keys are required to be not empty:\n * username, givenName, familyName, email.\n *\n * From RFC4517: A value of the Directory String syntax is a string of one or more\n * arbitrary characters from the Universal Character Set (UCS).\n * A zero-length character string is not permitted.\n */\n\nimport static org.forgerock.json.JsonValue.field\nimport static org.forgerock.json.JsonValue.json\nimport static org.forgerock.json.JsonValue.object\n\nString email = \"change@me.com\"\nString subjectId = rawProfile.sub\nString firstName = \" \"\nString lastName = \" \"\nString username = subjectId\nString name\n\nif (rawProfile.isDefined(\"email\") && rawProfile.email.isNotNull()){ // User can elect to not share their email\n    email = rawProfile.email.asString()\n    username = email\n}\nif (rawProfile.isDefined(\"name\") && rawProfile.name.isNotNull()) {\n    if (rawProfile.name.isDefined(\"firstName\") && rawProfile.name.firstName.isNotNull()) {\n        firstName = rawProfile.name.firstName.asString()\n    }\n    if (rawProfile.name.isDefined(\"lastName\") && rawProfile.name.lastName.isNotNull()) {\n        lastName = rawProfile.name.lastName.asString()\n    }\n}\n\nname = (firstName?.trim() ? firstName : \"\") + (lastName?.trim() ? ((firstName?.trim() ? \" \" : \"\") + lastName) : \"\")\nname =  (!name?.trim()) ? \" \" : name\n\nreturn json(object(\n        field(\"id\", subjectId),\n        field(\"displayName\", name),\n        field(\"email\", email),\n        field(\"givenName\", firstName),\n        field(\"familyName\", lastName),\n        field(\"username\", username)))"
