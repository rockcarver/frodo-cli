// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`frodo node export "frodo node export --all --no-metadata --file customNodeTest1.json --directory customNodeExportDir3 --use-string-arrays": should export all nodes to a single file named customNodeTest1.json in the directory customNodeExportDir3 with no metadata 1`] = `0`;

exports[`frodo node export "frodo node export --all --no-metadata --file customNodeTest1.json --directory customNodeExportDir3 --use-string-arrays": should export all nodes to a single file named customNodeTest1.json in the directory customNodeExportDir3 with no metadata 2`] = `""`;

exports[`frodo node export "frodo node export --all --no-metadata --file customNodeTest1.json --directory customNodeExportDir3 --use-string-arrays": should export all nodes to a single file named customNodeTest1.json in the directory customNodeExportDir3 with no metadata: customNodeExportDir3/customNodeTest1.json 1`] = `
{
  "nodeTypes": {
    "8ab9f1aad4b4460a9c45d15fb148e221-1": {
      "_id": "8ab9f1aad4b4460a9c45d15fb148e221-1",
      "description": "Debug node that displays the shared and transient state of the journey for debugging purposes.",
      "displayName": "Display State",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "displayFormat": {
          "defaultValue": "TABLE",
          "description": "The format in which to display the states.",
          "multivalued": false,
          "options": {
            "JSON": "Raw JSON",
            "TABLE": "HTML Table",
          },
          "required": true,
          "title": "Display Format",
          "type": "STRING",
        },
      },
      "script": [
        "var SCRIPT_OUTCOMES = {",
        "  OUTCOME: "outcome"",
        "};",
        "",
        "function main() {",
        "    if (!callbacks.isEmpty()) {",
        "        action.goTo(SCRIPT_OUTCOMES.OUTCOME);",
        "        return;",
        "    }",
        "    var keySet = nodeState.keys(); // Java Set<String>",
        "    var keys = Array.from(keySet); // Make it into JavaScript array",
        "    debugState = {};",
        "    for (var i in keys) {",
        "        var k = new String(keys[i]);",
        "        var item = nodeState.get(k);",
        "        if (typeof item === "object") {",
        "            debugState[k] = nodeState.getObject(k);",
        "        } else {",
        "            debugState[k] = nodeState.get(k);",
        "        }",
        "    }",
        "    if (properties.displayFormat === "JSON") {",
        "        callbacksBuilder.textOutputCallback(0, \`<pre style="text-align: left;">\${JSON.stringify(debugState, null, 2)}</pre>\`);",
        "        return;",
        "    }",
        "    callbacksBuilder.textOutputCallback(0, \`<table><tr><td style="border: 1px solid black;">Key</td><td style="border: 1px solid black;">Value</td></tr>\${Array.from(Object.keys(debugState).map(k => \`<tr><td style="border: 1px solid black;"><pre style="text-align: left;">\${k}</pre></td><td style="border: 1px solid black;"><pre style="text-align: left;">\${debugState[k]}</pre></td></tr>\`))}</table>\`);",
        "}",
        "",
        "main();",
        "",
      ],
      "serviceName": "8ab9f1aad4b4460a9c45d15fb148e221",
      "tags": [
        "debug",
        "testing",
      ],
    },
    "c15e2efb3deb4d4ea338c74a6440b69f-1": {
      "_id": "c15e2efb3deb4d4ea338c74a6440b69f-1",
      "description": "Simple ALU that performs basic binary vector math operations. Outputs the result onto the shared state with key "c".",
      "displayName": "Vector ALU",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "c",
      ],
      "properties": {
        "a": {
          "defaultValue": [
            1,
            2,
            3,
          ],
          "description": "Left vector operand",
          "multivalued": true,
          "required": true,
          "title": "A",
          "type": "NUMBER",
        },
        "b": {
          "defaultValue": [
            4,
            5,
            6,
          ],
          "description": "Right vector operand",
          "multivalued": true,
          "required": true,
          "title": "B",
          "type": "NUMBER",
        },
        "operator": {
          "defaultValue": "DOT",
          "description": "The binary operation to perform on the vectors.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "CROSS": "X",
            "DOT": ".",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": [
        "var SCRIPT_OUTCOMES = {",
        "    SUCCESS: 'Success'",
        "};",
        "",
        "var OPERATORS = {",
        "    ADD: "ADD",",
        "    SUBTRACT: "SUBTRACT",",
        "    DOT: "DOT",",
        "    CROSS: "CROSS"",
        "}",
        "",
        "function add(a, b) {",
        "    return a.map((v, i) => v + b[i]);",
        "}",
        "",
        "function subtract(a, b) {",
        "    return a.map((v, i) => v - b[i]);",
        "}",
        "",
        "function dot(a, b) {",
        "    return a.reduce((sum, v, i) => sum + v * b[i], 0);",
        "}",
        "",
        "function cross(a, b) {",
        "    return [",
        "        a[1] * b[2] - a[2] * b[1],",
        "        a[2] * b[0] - a[0] * b[2],",
        "        a[0] * b[1] - a[1] * b[0]",
        "    ];",
        "}",
        "",
        "function main() {",
        "    if (properties.a.length !== properties.b.length) throw new Error("Vectors not the same dimension.");",
        "    switch (properties.operator) {",
        "        case OPERATORS.ADD:",
        "            nodeState.putShared("c", add(properties.a, properties.b));",
        "            break;",
        "        case OPERATORS.SUBTRACT:",
        "            nodeState.putShared("c", subtract(properties.a, properties.b));",
        "            break;",
        "        case OPERATORS.DOT:",
        "            nodeState.putShared("c", dot(properties.a, properties.b));",
        "            break;",
        "        case OPERATORS.CROSS:",
        "            if (properties.a.length !== 3) throw new Error("Vectors not dimension 3 for cross product");",
        "            nodeState.putShared("c", cross(properties.a, properties.b));",
        "            break;",
        "        default: throw new Error("Unknown operator.");",
        "    }",
        "    action.goTo(SCRIPT_OUTCOMES.SUCCESS);",
        "}",
        "",
        "main();",
        "",
      ],
      "serviceName": "c15e2efb3deb4d4ea338c74a6440b69f",
      "tags": [
        "math",
        "vector",
        "utilities",
      ],
    },
    "c605506774a848f7877b4d17a453bd39-1": {
      "_id": "c605506774a848f7877b4d17a453bd39-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": [
        "var SCRIPT_OUTCOMES = {",
        "    TRUE: 'True',",
        "    FALSE: 'False'",
        "}",
        "",
        "function main() {",
        "    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);",
        "}",
        "",
        "main();",
        "",
      ],
      "serviceName": "c605506774a848f7877b4d17a453bd39",
      "tags": [
        "utilities",
      ],
    },
    "c6063fb2f5dc42dd9772bedc93898bd8-1": {
      "_id": "c6063fb2f5dc42dd9772bedc93898bd8-1",
      "description": "Simple ALU that performs basic binary math operations. Expects an "x" and "y" value on the shared state, and will produce a new "z" value on the shared state as output.",
      "displayName": "ALU",
      "errorOutcome": true,
      "inputs": [
        "x",
        "y",
      ],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "z",
      ],
      "properties": {
        "operator": {
          "defaultValue": "ADD",
          "description": "The operation to perform.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "DIVIDE": "/",
            "MULTIPLY": "*",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": [
        "var SCRIPT_OUTCOMES = {",
        "    SUCCESS: 'Success'",
        "};",
        "",
        "var OPERATORS = {",
        "    ADD: "ADD",",
        "    SUBTRACT: "SUBTRACT",",
        "    MULTIPLY: "MULTIPLY",",
        "    DIVIDE: "DIVIDE"",
        "}",
        "",
        "function main() {",
        "    var a = Number(properties.a);",
        "    var b = Number(properties.b);",
        "    switch (properties.operator) {",
        "        case OPERATORS.ADD:",
        "            nodeState.putShared("z", a + b);",
        "            break;",
        "        case OPERATORS.SUBTRACT:",
        "            nodeState.putShared("z", a - b);",
        "            break;",
        "        case OPERATORS.MULTIPLY:",
        "            nodeState.putShared("z", a * b);",
        "            break;",
        "        case OPERATORS.DIVIDE:",
        "            if (b == 0) throw new Error("Cannot divide by 0");",
        "            nodeState.putShared("z", a / b);",
        "            break;",
        "        default: throw new Error("Unknown operator.");",
        "    }",
        "    action.goTo(SCRIPT_OUTCOMES.SUCCESS);",
        "}",
        "",
        "main();",
        "",
      ],
      "serviceName": "c6063fb2f5dc42dd9772bedc93898bd8",
      "tags": [
        "math",
        "utilities",
      ],
    },
    "e5ad0110c8ee4dafaae983003cd05d4a-1": {
      "_id": "e5ad0110c8ee4dafaae983003cd05d4a-1",
      "description": "Generate a signed JWT using the HMAC SHA-256 algorithm.",
      "displayName": "Generate JWT",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {
        "audience": {
          "description": "The audience (aud) claim",
          "multivalued": false,
          "required": true,
          "title": "Audience",
          "type": "STRING",
        },
        "issuer": {
          "description": "The issuer (iss) claim",
          "multivalued": false,
          "required": true,
          "title": "Issuer",
          "type": "STRING",
        },
        "signingkey": {
          "defaultValue": "esv.signing.key",
          "description": "The secret label for the HMAC signing key",
          "multivalued": false,
          "required": true,
          "title": "HMAC Signing Key",
          "type": "STRING",
        },
        "validity": {
          "defaultValue": 5,
          "description": "",
          "multivalued": false,
          "required": true,
          "title": "Validity (minutes)",
          "type": "NUMBER",
        },
      },
      "script": [
        "var aud = properties.audience;",
        "var iss = properties.issuer;",
        "var validity = properties.validity;",
        "var esv = properties.signingkey;",
        "",
        "var signingkey = systemEnv.getProperty(esv);",
        "",
        "var username = nodeState.get("username");",
        "",
        "var data = {",
        "  jwtType:"SIGNED",",
        "  jwsAlgorithm: "HS256",",
        "  issuer: iss,",
        "  subject: username,",
        "  audience: aud,",
        "  type: "JWT",",
        "  validityMinutes: validity,",
        "  signingKey: signingkey",
        "};",
        "",
        "var jwt = jwtAssertion.generateJwt(data);",
        "",
        "if (jwt !== null && jwt.length > 0) {",
        "  nodeState.putShared("assertionJwt" , jwt);",
        "  action.goTo("True");",
        "} else {",
        "  action.goTo("False");",
        "}",
      ],
      "serviceName": "e5ad0110c8ee4dafaae983003cd05d4a",
      "tags": [
        "Utilities",
        "utilities",
      ],
    },
    "ef81b1a52c914710b3388caebfe7233a-1": {
      "_id": "ef81b1a52c914710b3388caebfe7233a-1",
      "description": "Displays custom callback to the page",
      "displayName": "Display Callback",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "callback": {
          "description": "The callback to display",
          "multivalued": false,
          "options": {
            "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK": "booleanAttributeInputCallback",
            "CHOICE_CALLBACK": "choiceCallback",
            "CONFIRMATION_CALLBACK": "confirmationCallback",
            "CONSENT_MAPPING_CALLBACK": "consentMappingCallback",
            "DEVICE_PROFILE_CALLBACK": "deviceProfileCallback",
            "HIDDEN_VALUE_CALLBACK": "hiddenValueCallback",
            "HTTP_CALLBACK": "httpCallback",
            "IDP_CALLBACK": "idPCallback",
            "KBA_CREATE_CALLBACK": "kbaCreateCallback",
            "LANGUAGE_CALLBACK": "languageCallback",
            "METADATA_CALLBACK": "metadataCallback",
            "NAME_CALLBACK": "nameCallback",
            "NUMBER_ATTRIBUTE_INPUT_CALLBACK": "numberAttributeInputCallback",
            "PASSWORD_CALLBACK": "passwordCallback",
            "POLLING_WAIT_CALLBACK": "pollingWaitCallback",
            "REDIRECT_CALLBACK": "redirectCallback",
            "SCRIPT_TEXT_OUTPUT_CALLBACK": "scriptTextOutputCallback",
            "SELECT_IDP_CALLBACK": "selectIdPCallback",
            "STRING_ATTRIBUTE_INPUT_CALLBACK": "stringAttributeInputCallback",
            "SUSPENDED_TEXT_OUTPUT_CALLBACK": "suspendedTextOutputCallback",
            "TERMS_AND_CONDITIONS_CALLBACK": "termsAndConditionsCallback",
            "TEXT_INPUT_CALLBACK": "textInputCallback",
            "TEXT_OUTPUT_CALLBACK": "textOutputCallback",
            "VALIDATED_PASSWORD_CALLBACK": "validatedPasswordCallback",
            "VALIDATED_USERNAME_CALLBACK": "validatedUsernameCallback",
            "X509_CERTIFICATE_CALLBACK": "x509CertificateCallback",
          },
          "required": true,
          "title": "Callback",
          "type": "STRING",
        },
        "objectSharedProperty": {
          "description": "The objectAttributes property on the shared state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Shared Property",
          "type": "STRING",
        },
        "objectTransientProperty": {
          "description": "The objectAttributes property on the transient state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Transient Property",
          "type": "STRING",
        },
        "options": {
          "description": "The options containing the parameters for the callback (see documentation for possible parameters: https://docs.pingidentity.com/pingoneaic/latest/am-scripting/scripting-api-node.html#scripting-api-node-callbacks). 

For example, for textOutputCallback, the options could be: { messageType: 0, message: "Hello World!" }. 

Note that for required parameters that are not specified in the options will use default values based on the type of the parameter ("" for Strings, [] for Arrays, {} for Objects, 0 for Ints, 0.0 for Doubles, and false for Booleans).",
          "multivalued": false,
          "required": true,
          "title": "Options",
          "type": "OBJECT",
        },
        "sharedProperty": {
          "description": "The shared state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Shared State Property",
          "type": "STRING",
        },
        "transientProperty": {
          "description": "The transient state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Transient State Property",
          "type": "STRING",
        },
      },
      "script": [
        "var SCRIPT_OUTCOMES = {",
        "    OUTCOME: 'outcome'",
        "};",
        "",
        "var CALLBACKS = {",
        "	BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK",",
        "	CHOICE_CALLBACK: "CHOICE_CALLBACK",",
        "	CONFIRMATION_CALLBACK: "CONFIRMATION_CALLBACK",",
        "	CONSENT_MAPPING_CALLBACK: "CONSENT_MAPPING_CALLBACK",",
        "	DEVICE_PROFILE_CALLBACK: "DEVICE_PROFILE_CALLBACK",",
        "	HIDDEN_VALUE_CALLBACK: "HIDDEN_VALUE_CALLBACK",",
        "	HTTP_CALLBACK: "HTTP_CALLBACK",",
        "	IDP_CALLBACK: "IDP_CALLBACK",",
        "	KBA_CREATE_CALLBACK: "KBA_CREATE_CALLBACK",",
        "	LANGUAGE_CALLBACK: "LANGUAGE_CALLBACK",",
        "	METADATA_CALLBACK: "METADATA_CALLBACK",",
        "	NAME_CALLBACK: "NAME_CALLBACK",",
        "	NUMBER_ATTRIBUTE_INPUT_CALLBACK: "NUMBER_ATTRIBUTE_INPUT_CALLBACK",",
        "	PASSWORD_CALLBACK: "PASSWORD_CALLBACK",",
        "	POLLING_WAIT_CALLBACK: "POLLING_WAIT_CALLBACK",",
        "    REDIRECT_CALLBACK: "REDIRECT_CALLBACK",",
        "	SCRIPT_TEXT_OUTPUT_CALLBACK: "SCRIPT_TEXT_OUTPUT_CALLBACK",",
        "	SELECT_IDP_CALLBACK: "SELECT_IDP_CALLBACK",",
        "	STRING_ATTRIBUTE_INPUT_CALLBACK: "STRING_ATTRIBUTE_INPUT_CALLBACK",",
        "	SUSPENDED_TEXT_OUTPUT_CALLBACK: "SUSPENDED_TEXT_OUTPUT_CALLBACK",",
        "	TERMS_AND_CONDITIONS_CALLBACK: "TERMS_AND_CONDITIONS_CALLBACK",",
        "	TEXT_INPUT_CALLBACK: "TEXT_INPUT_CALLBACK",",
        "	TEXT_OUTPUT_CALLBACK: "TEXT_OUTPUT_CALLBACK",",
        "	VALIDATED_PASSWORD_CALLBACK: "VALIDATED_PASSWORD_CALLBACK",",
        "	VALIDATED_USERNAME_CALLBACK: "VALIDATED_USERNAME_CALLBACK",",
        "	X509_CERTIFICATE_CALLBACK: "X509_CERTIFICATE_CALLBACK"",
        "}",
        "",
        "function isStringPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getString(value) {",
        "    return value || '';",
        "}",
        "",
        "function isArrayPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getArray(value) {",
        "    return value ? JSON.parse(value) : [];",
        "}",
        "",
        "function isObjectPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getObject(value) {",
        "    return value ? JSON.parse(value) : {};",
        "}",
        "",
        "function isIntPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getInt(value) {",
        "    return value ? parseInt(value) : 0;",
        "}",
        "",
        "function isDoublePresent(value) {",
        "    return value;",
        "}",
        "",
        "function getDouble(value) {",
        "    return value ? parseFloat(value) : 0.0;",
        "}",
        "",
        "function isBooleanPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getBoolean(value) {",
        "    return value ? value.toLowerCase() === 'true' : false;",
        "}",
        "",
        "function setProperty(value) {",
        "    if (properties.sharedProperty) nodeState.putShared(properties.sharedProperty, value);",
        "    if (properties.transientProperty) nodeState.putTransient(properties.transientProperty, value);",
        "    if (properties.objectSharedProperty) {",
        "        var attributes = {};",
        "        attributes[properties.objectSharedProperty] = value;",
        "        nodeState.mergeShared({",
        "            objectAttributes: attributes",
        "        });",
        "    }",
        "    if (properties.objectTransientProperty) {",
        "        var attributes = {};",
        "        attributes[properties.objectTransientProperty] = value;",
        "        nodeState.mergeTransient({",
        "            objectAttributes: attributes",
        "        });",
        "    }",
        "}",
        "",
        "function booleanAttributeInputCallback() {",
        "    var name = getString(properties.options.name);",
        "    var prompt = getString(properties.options.prompt);",
        "    var value = getBoolean(properties.options.value);",
        "    var required = getBoolean(properties.options.required);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {",
        "        if (isArrayPresent(failedPolicies)) {",
        "            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);",
        "        } else {",
        "            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly);",
        "        }",
        "    } else if (isArrayPresent(failedPolicies)) {",
        "        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required);",
        "    }",
        "}",
        "",
        "function choiceCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var choices = getArray(properties.options.choices);",
        "    var defaultChoice = getInt(properties.options.defaultChoice);",
        "    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);",
        "    callbacksBuilder.choiceCallback(prompt, choices, defaultChoice, multipleSelectionsAllowed);",
        "}",
        "",
        "function confirmationCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var messageType = getInt(properties.options.messageType);",
        "    var options = getArray(properties.options.options);",
        "    var optionType = getInt(properties.options.optionType);",
        "    var defaultOption = getInt(properties.options.defaultOption);",
        "    if (isStringPresent(properties.options.prompt)) {",
        "        if (isIntPresent(properties.options.optionType)) {",
        "            callbacksBuilder.confirmationCallback(prompt, messageType, optionType, defaultOption);",
        "        } else {",
        "            callbacksBuilder.confirmationCallback(prompt, messageType, options, defaultOption);",
        "        }",
        "    } else {",
        "        if (isIntPresent(properties.options.optionType)) {",
        "            callbacksBuilder.confirmationCallback(messageType, optionType, defaultOption);",
        "        } else {",
        "            callbacksBuilder.confirmationCallback(messageType, options, defaultOption);",
        "        }",
        "    }",
        "}",
        "",
        "function consentMappingCallback() {",
        "    var config = getObject(properties.options.config);",
        "    var message = getString(properties.options.message);",
        "    var isRequired = getBoolean(properties.options.isRequired);",
        "    var name = getString(properties.options.name);",
        "    var displayName = getString(properties.options.displayName);",
        "    var icon = getString(properties.options.icon);",
        "    var accessLevel = getString(properties.options.accessLevel);",
        "    var titles = getArray(properties.options.titles);",
        "    if (isObjectPresent(properties.options.prompt)) {",
        "        callbacksBuilder.consentMappingCallback(config, message, isRequired);",
        "    } else {",
        "        callbacksBuilder.consentMappingCallback(name, displayName, icon, accessLevel, titles, message, isRequired);",
        "    }",
        "}",
        "",
        "function deviceProfileCallback() {",
        "    var metadata = getBoolean(properties.options.metadata);",
        "    var location = getBoolean(properties.options.location);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.deviceProfileCallback(metadata, location, message);",
        "}",
        "",
        "function hiddenValueCallback() {",
        "    var id = getString(properties.options.id);",
        "    var value = getString(properties.options.value);",
        "    callbacksBuilder.hiddenValueCallback(id, value);",
        "}",
        "",
        "function httpCallback() {",
        "    var authorizationHeader = getString(properties.options.authorizationHeader);",
        "    var negotiationHeader = getString(properties.options.negotiationHeader);",
        "    var authRHeader = getString(properties.options.authRHeader);",
        "    var negoName = getString(properties.options.negoName);",
        "    var negoValue = getString(properties.options.negoValue);",
        "    if (isStringPresent(properties.options.authorizationHeader) || isStringPresent(properties.options.negotiationHeader)) {",
        "        var errorCode = getString(properties.options.errorCode);",
        "        callbacksBuilder.httpCallback(authorizationHeader, negotiationHeader, errorCode);",
        "    } else {",
        "        var errorCode = getInt(properties.options.errorCode);",
        "        callbacksBuilder.httpCallback(authRHeader, negoName, negoValue, errorCode);",
        "    }",
        "}",
        "",
        "function idPCallback() {",
        "    var provider = getString(properties.options.provider);",
        "    var clientId = getString(properties.options.clientId);",
        "    var redirectUri = getString(properties.options.redirectUri);",
        "    var scope = getArray(properties.options.scope);",
        "    var nonce = getString(properties.options.nonce);",
        "    var request = getString(properties.options.request);",
        "    var requestUri = getString(properties.options.requestUri);",
        "    var acrValues = getArray(properties.options.acrValues);",
        "    var requestNativeAppForUserInfo = getBoolean(properties.options.requestNativeAppForUserInfo);",
        "    var token = getString(properties.options.token);",
        "    var tokenType = getString(properties.options.tokenType);",
        "    if (isStringPresent(properties.options.token) || isStringPresent(properties.options.tokenType)) {",
        "        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo, token, tokenType);",
        "    } else {",
        "        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo);",
        "    }",
        "}",
        "",
        "function kbaCreateCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var predefinedQuestions = getArray(properties.options.predefinedQuestions);",
        "    var allowUserDefinedQuestions = getBoolean(properties.options.allowUserDefinedQuestions);",
        "    callbacksBuilder.kbaCreateCallback(prompt, predefinedQuestions, allowUserDefinedQuestions);",
        "}",
        "",
        "function languageCallback() {",
        "    var language = getString(properties.options.language);",
        "    var country = getString(properties.options.country);",
        "    callbacksBuilder.languageCallback(language, country);",
        "}",
        "",
        "function metadataCallback() {",
        "    var outputValue = getObject(properties.options.outputValue);",
        "    callbacksBuilder.metadataCallback(outputValue);",
        "}",
        "",
        "function nameCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var defaultName = getString(properties.options.defaultName);",
        "    if (isStringPresent(properties.options.defaultName)) {",
        "        callbacksBuilder.nameCallback(prompt, defaultName);",
        "    } else {",
        "        callbacksBuilder.nameCallback(prompt);",
        "    }",
        "}",
        "",
        "function numberAttributeInputCallback() {",
        "    var name = getString(properties.options.name);",
        "    var prompt = getString(properties.options.prompt);",
        "    var value = getDouble(properties.options.value);",
        "    var required = getBoolean(properties.options.required);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {",
        "        if (isArrayPresent(failedPolicies)) {",
        "            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);",
        "        } else {",
        "            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly);",
        "        }",
        "    } else if (isArrayPresent(failedPolicies)) {",
        "        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required);",
        "    }",
        "}",
        "",
        "function passwordCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var echoOn = getBoolean(properties.options.echoOn);",
        "    callbacksBuilder.passwordCallback(prompt, echoOn);",
        "}",
        "",
        "function pollingWaitCallback() {",
        "    var waitTime = getString(properties.options.waitTime);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.pollingWaitCallback(waitTime, message);",
        "}",
        "",
        "function redirectCallback() {",
        "    throw new Error('Not Implemented');",
        "}",
        "",
        "function scriptTextOutputCallback() {",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.scriptTextOutputCallback(message);",
        "}",
        "",
        "function selectIdPCallback() {",
        "    var providers = getObject(properties.options.providers);",
        "    callbacksBuilder.selectIdPCallback(providers);",
        "}",
        "",
        "function stringAttributeInputCallback() {",
        "    var name = getString(properties.options.name);",
        "    var prompt = getString(properties.options.prompt);",
        "    var value = getString(properties.options.value);",
        "    var required = getBoolean(properties.options.required);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {",
        "        if (isArrayPresent(failedPolicies)) {",
        "            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);",
        "        } else {",
        "            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly);",
        "        }",
        "    } else if (isArrayPresent(failedPolicies)) {",
        "        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required);",
        "    }",
        "}",
        "",
        "function suspendedTextOutputCallback() {",
        "    var messageType = getInt(properties.options.messageType);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.suspendedTextOutputCallback(messageType, message);",
        "}",
        "",
        "function termsAndConditionsCallback() {",
        "    var version = getString(properties.options.version);",
        "    var terms = getString(properties.options.terms);",
        "    var createDate = getString(properties.options.createDate);",
        "    callbacksBuilder.termsAndConditionsCallback(version, terms, createDate);",
        "}",
        "",
        "function textInputCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var defaultText = getString(properties.options.defaultText);",
        "    if (isStringPresent(properties.options.defaultText)) {",
        "        callbacksBuilder.textInputCallback(prompt, defaultText);",
        "    } else {",
        "        callbacksBuilder.textInputCallback(prompt);",
        "    }",
        "}",
        "",
        "function textOutputCallback() {",
        "    var messageType = getString(properties.options.messageType);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.textOutputCallback(messageType, message);",
        "}",
        "",
        "function validatedPasswordCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var echoOn = getBoolean(properties.options.echoOn);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isArrayPresent(properties.options.failedPolicies)) {",
        "        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly);",
        "    }",
        "}",
        "",
        "function validatedUsernameCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isArrayPresent(properties.options.failedPolicies)) {",
        "        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly);",
        "    }",
        "}",
        "",
        "function x509CertificateCallback() {",
        "    throw new Error('Not Implemented');",
        "}",
        "",
        "function getBooleanAttributeInputCallback() {",
        "    setProperty(callbacks.getBooleanAttributeInputCallbacks().get(0));",
        "}",
        "",
        "function getChoiceCallback() {",
        "    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);",
        "    var selections = callbacks.getChoiceCallbacks().get(0);",
        "    setProperty(multipleSelectionsAllowed ? selections : selections[0]);",
        "}",
        "",
        "function getConfirmationCallback() {",
        "    setProperty(callbacks.getConfirmationCallbacks().get(0));",
        "}",
        "",
        "function getConsentMappingCallback() {",
        "    setProperty(callbacks.getConsentMappingCallbacks().get(0));",
        "}",
        "",
        "function getDeviceProfileCallback() {",
        "    setProperty(callbacks.getDeviceProfileCallbacks().get(0));",
        "}",
        "",
        "function getHiddenValueCallback() {",
        "    var id = getString(properties.options.id);",
        "    setProperty(callbacks.getHiddenValueCallbacks().get(id));",
        "}",
        "",
        "function getHttpCallback() {",
        "    setProperty(callbacks.getHttpCallbacks().get(0));",
        "}",
        "",
        "function getIdPCallback() {",
        "    setProperty(callbacks.getIdpCallbacks().get(0));",
        "}",
        "",
        "function getKbaCreateCallback() {",
        "    setProperty(callbacks.getKbaCreateCallbacks().get(0));",
        "}",
        "",
        "function getLanguageCallback() {",
        "    setProperty(callbacks.getLanguageCallbacks().get(0));",
        "}",
        "",
        "function getNameCallback() {",
        "    setProperty(callbacks.getNameCallbacks().get(0));",
        "}",
        "",
        "function getNumberAttributeInputCallback() {",
        "    setProperty(callbacks.getNumberAttributeInputCallbacks().get(0));",
        "}",
        "",
        "function getPasswordCallback() {",
        "    setProperty(callbacks.getPasswordCallbacks().get(0));",
        "}",
        "",
        "function getSelectIdPCallback() {",
        "    setProperty(callbacks.getSelectIdPCallbacks().get(0));",
        "}",
        "",
        "function getStringAttributeInputCallback() {",
        "    setProperty(callbacks.getStringAttributeInputCallbacks().get(0));",
        "}",
        "",
        "function getTermsAndConditionsCallback() {",
        "    setProperty(callbacks.getTermsAndConditionsCallbacks().get(0));",
        "}",
        "",
        "function getTextInputCallback() {",
        "    setProperty(callbacks.getTextInputCallbacks().get(0));",
        "}",
        "",
        "function getValidatedPasswordCallback() {",
        "    setProperty(callbacks.getValidatedPasswordCallbacks().get(0));",
        "}",
        "",
        "function getValidatedUsernameCallback() {",
        "    setProperty(callbacks.getValidatedUsernameCallbacks().get(0));",
        "}",
        "",
        "function getX509CertificateCallback() {",
        "    setProperty(callbacks.getX509CertificateCallbacks().get(0));",
        "}",
        "",
        "function main() {",
        "    if (!callbacks.isEmpty()) {",
        "        switch (properties.callback) {",
        "            case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: getBooleanAttributeInputCallback(); break;",
        "            case CALLBACKS.CHOICE_CALLBACK: getChoiceCallback(); break;",
        "            case CALLBACKS.CONFIRMATION_CALLBACK: getConfirmationCallback(); break;",
        "            case CALLBACKS.CONSENT_MAPPING_CALLBACK: getConsentMappingCallback(); break;",
        "            case CALLBACKS.DEVICE_PROFILE_CALLBACK: getDeviceProfileCallback(); break;",
        "            case CALLBACKS.HIDDEN_VALUE_CALLBACK: getHiddenValueCallback(); break;",
        "            case CALLBACKS.HTTP_CALLBACK: getHttpCallback(); break;",
        "            case CALLBACKS.IDP_CALLBACK: getIdPCallback(); break;",
        "            case CALLBACKS.KBA_CREATE_CALLBACK: getKbaCreateCallback(); break;",
        "            case CALLBACKS.LANGUAGE_CALLBACK: getLanguageCallback(); break;",
        "            case CALLBACKS.NAME_CALLBACK: getNameCallback(); break;",
        "            case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: getNumberAttributeInputCallback(); break;",
        "            case CALLBACKS.PASSWORD_CALLBACK: getPasswordCallback(); break;",
        "            case CALLBACKS.SELECT_IDP_CALLBACK: getSelectIdPCallback(); break;",
        "            case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: getStringAttributeInputCallback(); break;",
        "            case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: getTermsAndConditionsCallback(); break;",
        "            case CALLBACKS.TEXT_INPUT_CALLBACK: getTextInputCallback(); break;",
        "            case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: getValidatedPasswordCallback(); break;",
        "            case CALLBACKS.VALIDATED_USERNAME_CALLBACK: getValidatedUsernameCallback(); break;",
        "            case CALLBACKS.X509_CERTIFICATE_CALLBACK: getX509CertificateCallback(); break;",
        "            default: break;",
        "        }",
        "        action.goTo(SCRIPT_OUTCOMES.OUTCOME);",
        "        return;",
        "    }",
        "",
        "    switch (properties.callback) {",
        "        case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: booleanAttributeInputCallback(); break;",
        "        case CALLBACKS.CHOICE_CALLBACK: choiceCallback(); break;",
        "        case CALLBACKS.CONFIRMATION_CALLBACK: confirmationCallback(); break;",
        "        case CALLBACKS.CONSENT_MAPPING_CALLBACK: consentMappingCallback(); break;",
        "        case CALLBACKS.DEVICE_PROFILE_CALLBACK: deviceProfileCallback(); break;",
        "        case CALLBACKS.HIDDEN_VALUE_CALLBACK: hiddenValueCallback(); break;",
        "        case CALLBACKS.HTTP_CALLBACK: httpCallback(); break;",
        "        case CALLBACKS.IDP_CALLBACK: idPCallback(); break;",
        "        case CALLBACKS.KBA_CREATE_CALLBACK: kbaCreateCallback(); break;",
        "        case CALLBACKS.LANGUAGE_CALLBACK: languageCallback(); break;",
        "        case CALLBACKS.METADATA_CALLBACK: metadataCallback(); break;",
        "        case CALLBACKS.NAME_CALLBACK: nameCallback(); break;",
        "        case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: numberAttributeInputCallback(); break;",
        "        case CALLBACKS.PASSWORD_CALLBACK: passwordCallback(); break;",
        "        case CALLBACKS.POLLING_WAIT_CALLBACK: pollingWaitCallback(); break;",
        "        case CALLBACKS.REDIRECT_CALLBACK: redirectCallback(); break;",
        "        case CALLBACKS.SCRIPT_TEXT_OUTPUT_CALLBACK: scriptTextOutputCallback(); break;",
        "        case CALLBACKS.SELECT_IDP_CALLBACK: selectIdPCallback(); break;",
        "        case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: stringAttributeInputCallback(); break;",
        "        case CALLBACKS.SUSPENDED_TEXT_OUTPUT_CALLBACK: suspendedTextOutputCallback(); break;",
        "        case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: termsAndConditionsCallback(); break;",
        "        case CALLBACKS.TEXT_INPUT_CALLBACK: textInputCallback(); break;",
        "        case CALLBACKS.TEXT_OUTPUT_CALLBACK: textOutputCallback(); break;",
        "        case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: validatedPasswordCallback(); break;",
        "        case CALLBACKS.VALIDATED_USERNAME_CALLBACK: validatedUsernameCallback(); break;",
        "        case CALLBACKS.X509_CERTIFICATE_CALLBACK: x509CertificateCallback(); break;",
        "        default: throw new Error('Unknown Callback'); // Should never reach this case",
        "    }",
        "}",
        "",
        "main();",
        "",
      ],
      "serviceName": "ef81b1a52c914710b3388caebfe7233a",
      "tags": [
        "callback",
        "utilities",
      ],
    },
    "session-1": {
      "_id": "session-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session AM",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": [
        "var SCRIPT_OUTCOMES = {",
        "    TRUE: 'True',",
        "    FALSE: 'False'",
        "}",
        "",
        "function main() {",
        "    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);",
        "}",
        "",
        "main();",
        "",
      ],
      "serviceName": "session",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5 1`] = `0`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5 2`] = `""`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/ALU.nodeTypes.js 1`] = `
"var SCRIPT_OUTCOMES = {
    SUCCESS: 'Success'
};

var OPERATORS = {
    ADD: "ADD",
    SUBTRACT: "SUBTRACT",
    MULTIPLY: "MULTIPLY",
    DIVIDE: "DIVIDE"
}

function main() {
    var a = Number(properties.a);
    var b = Number(properties.b);
    switch (properties.operator) {
        case OPERATORS.ADD:
            nodeState.putShared("z", a + b);
            break;
        case OPERATORS.SUBTRACT:
            nodeState.putShared("z", a - b);
            break;
        case OPERATORS.MULTIPLY:
            nodeState.putShared("z", a * b);
            break;
        case OPERATORS.DIVIDE:
            if (b == 0) throw new Error("Cannot divide by 0");
            nodeState.putShared("z", a / b);
            break;
        default: throw new Error("Unknown operator.");
    }
    action.goTo(SCRIPT_OUTCOMES.SUCCESS);
}

main();
"
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/ALU.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "c6063fb2f5dc42dd9772bedc93898bd8-1": {
      "_id": "c6063fb2f5dc42dd9772bedc93898bd8-1",
      "description": "Simple ALU that performs basic binary math operations. Expects an "x" and "y" value on the shared state, and will produce a new "z" value on the shared state as output.",
      "displayName": "ALU",
      "errorOutcome": true,
      "inputs": [
        "x",
        "y",
      ],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "z",
      ],
      "properties": {
        "operator": {
          "defaultValue": "ADD",
          "description": "The operation to perform.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "DIVIDE": "/",
            "MULTIPLY": "*",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": "file://ALU.nodeTypes.js",
      "serviceName": "c6063fb2f5dc42dd9772bedc93898bd8",
      "tags": [
        "math",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Display-Callback.nodeTypes.js 1`] = `
"var SCRIPT_OUTCOMES = {
    OUTCOME: 'outcome'
};

var CALLBACKS = {
	BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK",
	CHOICE_CALLBACK: "CHOICE_CALLBACK",
	CONFIRMATION_CALLBACK: "CONFIRMATION_CALLBACK",
	CONSENT_MAPPING_CALLBACK: "CONSENT_MAPPING_CALLBACK",
	DEVICE_PROFILE_CALLBACK: "DEVICE_PROFILE_CALLBACK",
	HIDDEN_VALUE_CALLBACK: "HIDDEN_VALUE_CALLBACK",
	HTTP_CALLBACK: "HTTP_CALLBACK",
	IDP_CALLBACK: "IDP_CALLBACK",
	KBA_CREATE_CALLBACK: "KBA_CREATE_CALLBACK",
	LANGUAGE_CALLBACK: "LANGUAGE_CALLBACK",
	METADATA_CALLBACK: "METADATA_CALLBACK",
	NAME_CALLBACK: "NAME_CALLBACK",
	NUMBER_ATTRIBUTE_INPUT_CALLBACK: "NUMBER_ATTRIBUTE_INPUT_CALLBACK",
	PASSWORD_CALLBACK: "PASSWORD_CALLBACK",
	POLLING_WAIT_CALLBACK: "POLLING_WAIT_CALLBACK",
    REDIRECT_CALLBACK: "REDIRECT_CALLBACK",
	SCRIPT_TEXT_OUTPUT_CALLBACK: "SCRIPT_TEXT_OUTPUT_CALLBACK",
	SELECT_IDP_CALLBACK: "SELECT_IDP_CALLBACK",
	STRING_ATTRIBUTE_INPUT_CALLBACK: "STRING_ATTRIBUTE_INPUT_CALLBACK",
	SUSPENDED_TEXT_OUTPUT_CALLBACK: "SUSPENDED_TEXT_OUTPUT_CALLBACK",
	TERMS_AND_CONDITIONS_CALLBACK: "TERMS_AND_CONDITIONS_CALLBACK",
	TEXT_INPUT_CALLBACK: "TEXT_INPUT_CALLBACK",
	TEXT_OUTPUT_CALLBACK: "TEXT_OUTPUT_CALLBACK",
	VALIDATED_PASSWORD_CALLBACK: "VALIDATED_PASSWORD_CALLBACK",
	VALIDATED_USERNAME_CALLBACK: "VALIDATED_USERNAME_CALLBACK",
	X509_CERTIFICATE_CALLBACK: "X509_CERTIFICATE_CALLBACK"
}

function isStringPresent(value) {
    return value;
}

function getString(value) {
    return value || '';
}

function isArrayPresent(value) {
    return value;
}

function getArray(value) {
    return value ? JSON.parse(value) : [];
}

function isObjectPresent(value) {
    return value;
}

function getObject(value) {
    return value ? JSON.parse(value) : {};
}

function isIntPresent(value) {
    return value;
}

function getInt(value) {
    return value ? parseInt(value) : 0;
}

function isDoublePresent(value) {
    return value;
}

function getDouble(value) {
    return value ? parseFloat(value) : 0.0;
}

function isBooleanPresent(value) {
    return value;
}

function getBoolean(value) {
    return value ? value.toLowerCase() === 'true' : false;
}

function setProperty(value) {
    if (properties.sharedProperty) nodeState.putShared(properties.sharedProperty, value);
    if (properties.transientProperty) nodeState.putTransient(properties.transientProperty, value);
    if (properties.objectSharedProperty) {
        var attributes = {};
        attributes[properties.objectSharedProperty] = value;
        nodeState.mergeShared({
            objectAttributes: attributes
        });
    }
    if (properties.objectTransientProperty) {
        var attributes = {};
        attributes[properties.objectTransientProperty] = value;
        nodeState.mergeTransient({
            objectAttributes: attributes
        });
    }
}

function booleanAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getBoolean(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required);
    }
}

function choiceCallback() {
    var prompt = getString(properties.options.prompt);
    var choices = getArray(properties.options.choices);
    var defaultChoice = getInt(properties.options.defaultChoice);
    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);
    callbacksBuilder.choiceCallback(prompt, choices, defaultChoice, multipleSelectionsAllowed);
}

function confirmationCallback() {
    var prompt = getString(properties.options.prompt);
    var messageType = getInt(properties.options.messageType);
    var options = getArray(properties.options.options);
    var optionType = getInt(properties.options.optionType);
    var defaultOption = getInt(properties.options.defaultOption);
    if (isStringPresent(properties.options.prompt)) {
        if (isIntPresent(properties.options.optionType)) {
            callbacksBuilder.confirmationCallback(prompt, messageType, optionType, defaultOption);
        } else {
            callbacksBuilder.confirmationCallback(prompt, messageType, options, defaultOption);
        }
    } else {
        if (isIntPresent(properties.options.optionType)) {
            callbacksBuilder.confirmationCallback(messageType, optionType, defaultOption);
        } else {
            callbacksBuilder.confirmationCallback(messageType, options, defaultOption);
        }
    }
}

function consentMappingCallback() {
    var config = getObject(properties.options.config);
    var message = getString(properties.options.message);
    var isRequired = getBoolean(properties.options.isRequired);
    var name = getString(properties.options.name);
    var displayName = getString(properties.options.displayName);
    var icon = getString(properties.options.icon);
    var accessLevel = getString(properties.options.accessLevel);
    var titles = getArray(properties.options.titles);
    if (isObjectPresent(properties.options.prompt)) {
        callbacksBuilder.consentMappingCallback(config, message, isRequired);
    } else {
        callbacksBuilder.consentMappingCallback(name, displayName, icon, accessLevel, titles, message, isRequired);
    }
}

function deviceProfileCallback() {
    var metadata = getBoolean(properties.options.metadata);
    var location = getBoolean(properties.options.location);
    var message = getString(properties.options.message);
    callbacksBuilder.deviceProfileCallback(metadata, location, message);
}

function hiddenValueCallback() {
    var id = getString(properties.options.id);
    var value = getString(properties.options.value);
    callbacksBuilder.hiddenValueCallback(id, value);
}

function httpCallback() {
    var authorizationHeader = getString(properties.options.authorizationHeader);
    var negotiationHeader = getString(properties.options.negotiationHeader);
    var authRHeader = getString(properties.options.authRHeader);
    var negoName = getString(properties.options.negoName);
    var negoValue = getString(properties.options.negoValue);
    if (isStringPresent(properties.options.authorizationHeader) || isStringPresent(properties.options.negotiationHeader)) {
        var errorCode = getString(properties.options.errorCode);
        callbacksBuilder.httpCallback(authorizationHeader, negotiationHeader, errorCode);
    } else {
        var errorCode = getInt(properties.options.errorCode);
        callbacksBuilder.httpCallback(authRHeader, negoName, negoValue, errorCode);
    }
}

function idPCallback() {
    var provider = getString(properties.options.provider);
    var clientId = getString(properties.options.clientId);
    var redirectUri = getString(properties.options.redirectUri);
    var scope = getArray(properties.options.scope);
    var nonce = getString(properties.options.nonce);
    var request = getString(properties.options.request);
    var requestUri = getString(properties.options.requestUri);
    var acrValues = getArray(properties.options.acrValues);
    var requestNativeAppForUserInfo = getBoolean(properties.options.requestNativeAppForUserInfo);
    var token = getString(properties.options.token);
    var tokenType = getString(properties.options.tokenType);
    if (isStringPresent(properties.options.token) || isStringPresent(properties.options.tokenType)) {
        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo, token, tokenType);
    } else {
        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo);
    }
}

function kbaCreateCallback() {
    var prompt = getString(properties.options.prompt);
    var predefinedQuestions = getArray(properties.options.predefinedQuestions);
    var allowUserDefinedQuestions = getBoolean(properties.options.allowUserDefinedQuestions);
    callbacksBuilder.kbaCreateCallback(prompt, predefinedQuestions, allowUserDefinedQuestions);
}

function languageCallback() {
    var language = getString(properties.options.language);
    var country = getString(properties.options.country);
    callbacksBuilder.languageCallback(language, country);
}

function metadataCallback() {
    var outputValue = getObject(properties.options.outputValue);
    callbacksBuilder.metadataCallback(outputValue);
}

function nameCallback() {
    var prompt = getString(properties.options.prompt);
    var defaultName = getString(properties.options.defaultName);
    if (isStringPresent(properties.options.defaultName)) {
        callbacksBuilder.nameCallback(prompt, defaultName);
    } else {
        callbacksBuilder.nameCallback(prompt);
    }
}

function numberAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getDouble(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required);
    }
}

function passwordCallback() {
    var prompt = getString(properties.options.prompt);
    var echoOn = getBoolean(properties.options.echoOn);
    callbacksBuilder.passwordCallback(prompt, echoOn);
}

function pollingWaitCallback() {
    var waitTime = getString(properties.options.waitTime);
    var message = getString(properties.options.message);
    callbacksBuilder.pollingWaitCallback(waitTime, message);
}

function redirectCallback() {
    throw new Error('Not Implemented');
}

function scriptTextOutputCallback() {
    var message = getString(properties.options.message);
    callbacksBuilder.scriptTextOutputCallback(message);
}

function selectIdPCallback() {
    var providers = getObject(properties.options.providers);
    callbacksBuilder.selectIdPCallback(providers);
}

function stringAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getString(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required);
    }
}

function suspendedTextOutputCallback() {
    var messageType = getInt(properties.options.messageType);
    var message = getString(properties.options.message);
    callbacksBuilder.suspendedTextOutputCallback(messageType, message);
}

function termsAndConditionsCallback() {
    var version = getString(properties.options.version);
    var terms = getString(properties.options.terms);
    var createDate = getString(properties.options.createDate);
    callbacksBuilder.termsAndConditionsCallback(version, terms, createDate);
}

function textInputCallback() {
    var prompt = getString(properties.options.prompt);
    var defaultText = getString(properties.options.defaultText);
    if (isStringPresent(properties.options.defaultText)) {
        callbacksBuilder.textInputCallback(prompt, defaultText);
    } else {
        callbacksBuilder.textInputCallback(prompt);
    }
}

function textOutputCallback() {
    var messageType = getString(properties.options.messageType);
    var message = getString(properties.options.message);
    callbacksBuilder.textOutputCallback(messageType, message);
}

function validatedPasswordCallback() {
    var prompt = getString(properties.options.prompt);
    var echoOn = getBoolean(properties.options.echoOn);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isArrayPresent(properties.options.failedPolicies)) {
        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly, failedPolicies);
    } else {
        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly);
    }
}

function validatedUsernameCallback() {
    var prompt = getString(properties.options.prompt);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isArrayPresent(properties.options.failedPolicies)) {
        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly, failedPolicies);
    } else {
        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly);
    }
}

function x509CertificateCallback() {
    throw new Error('Not Implemented');
}

function getBooleanAttributeInputCallback() {
    setProperty(callbacks.getBooleanAttributeInputCallbacks().get(0));
}

function getChoiceCallback() {
    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);
    var selections = callbacks.getChoiceCallbacks().get(0);
    setProperty(multipleSelectionsAllowed ? selections : selections[0]);
}

function getConfirmationCallback() {
    setProperty(callbacks.getConfirmationCallbacks().get(0));
}

function getConsentMappingCallback() {
    setProperty(callbacks.getConsentMappingCallbacks().get(0));
}

function getDeviceProfileCallback() {
    setProperty(callbacks.getDeviceProfileCallbacks().get(0));
}

function getHiddenValueCallback() {
    var id = getString(properties.options.id);
    setProperty(callbacks.getHiddenValueCallbacks().get(id));
}

function getHttpCallback() {
    setProperty(callbacks.getHttpCallbacks().get(0));
}

function getIdPCallback() {
    setProperty(callbacks.getIdpCallbacks().get(0));
}

function getKbaCreateCallback() {
    setProperty(callbacks.getKbaCreateCallbacks().get(0));
}

function getLanguageCallback() {
    setProperty(callbacks.getLanguageCallbacks().get(0));
}

function getNameCallback() {
    setProperty(callbacks.getNameCallbacks().get(0));
}

function getNumberAttributeInputCallback() {
    setProperty(callbacks.getNumberAttributeInputCallbacks().get(0));
}

function getPasswordCallback() {
    setProperty(callbacks.getPasswordCallbacks().get(0));
}

function getSelectIdPCallback() {
    setProperty(callbacks.getSelectIdPCallbacks().get(0));
}

function getStringAttributeInputCallback() {
    setProperty(callbacks.getStringAttributeInputCallbacks().get(0));
}

function getTermsAndConditionsCallback() {
    setProperty(callbacks.getTermsAndConditionsCallbacks().get(0));
}

function getTextInputCallback() {
    setProperty(callbacks.getTextInputCallbacks().get(0));
}

function getValidatedPasswordCallback() {
    setProperty(callbacks.getValidatedPasswordCallbacks().get(0));
}

function getValidatedUsernameCallback() {
    setProperty(callbacks.getValidatedUsernameCallbacks().get(0));
}

function getX509CertificateCallback() {
    setProperty(callbacks.getX509CertificateCallbacks().get(0));
}

function main() {
    if (!callbacks.isEmpty()) {
        switch (properties.callback) {
            case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: getBooleanAttributeInputCallback(); break;
            case CALLBACKS.CHOICE_CALLBACK: getChoiceCallback(); break;
            case CALLBACKS.CONFIRMATION_CALLBACK: getConfirmationCallback(); break;
            case CALLBACKS.CONSENT_MAPPING_CALLBACK: getConsentMappingCallback(); break;
            case CALLBACKS.DEVICE_PROFILE_CALLBACK: getDeviceProfileCallback(); break;
            case CALLBACKS.HIDDEN_VALUE_CALLBACK: getHiddenValueCallback(); break;
            case CALLBACKS.HTTP_CALLBACK: getHttpCallback(); break;
            case CALLBACKS.IDP_CALLBACK: getIdPCallback(); break;
            case CALLBACKS.KBA_CREATE_CALLBACK: getKbaCreateCallback(); break;
            case CALLBACKS.LANGUAGE_CALLBACK: getLanguageCallback(); break;
            case CALLBACKS.NAME_CALLBACK: getNameCallback(); break;
            case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: getNumberAttributeInputCallback(); break;
            case CALLBACKS.PASSWORD_CALLBACK: getPasswordCallback(); break;
            case CALLBACKS.SELECT_IDP_CALLBACK: getSelectIdPCallback(); break;
            case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: getStringAttributeInputCallback(); break;
            case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: getTermsAndConditionsCallback(); break;
            case CALLBACKS.TEXT_INPUT_CALLBACK: getTextInputCallback(); break;
            case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: getValidatedPasswordCallback(); break;
            case CALLBACKS.VALIDATED_USERNAME_CALLBACK: getValidatedUsernameCallback(); break;
            case CALLBACKS.X509_CERTIFICATE_CALLBACK: getX509CertificateCallback(); break;
            default: break;
        }
        action.goTo(SCRIPT_OUTCOMES.OUTCOME);
        return;
    }

    switch (properties.callback) {
        case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: booleanAttributeInputCallback(); break;
        case CALLBACKS.CHOICE_CALLBACK: choiceCallback(); break;
        case CALLBACKS.CONFIRMATION_CALLBACK: confirmationCallback(); break;
        case CALLBACKS.CONSENT_MAPPING_CALLBACK: consentMappingCallback(); break;
        case CALLBACKS.DEVICE_PROFILE_CALLBACK: deviceProfileCallback(); break;
        case CALLBACKS.HIDDEN_VALUE_CALLBACK: hiddenValueCallback(); break;
        case CALLBACKS.HTTP_CALLBACK: httpCallback(); break;
        case CALLBACKS.IDP_CALLBACK: idPCallback(); break;
        case CALLBACKS.KBA_CREATE_CALLBACK: kbaCreateCallback(); break;
        case CALLBACKS.LANGUAGE_CALLBACK: languageCallback(); break;
        case CALLBACKS.METADATA_CALLBACK: metadataCallback(); break;
        case CALLBACKS.NAME_CALLBACK: nameCallback(); break;
        case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: numberAttributeInputCallback(); break;
        case CALLBACKS.PASSWORD_CALLBACK: passwordCallback(); break;
        case CALLBACKS.POLLING_WAIT_CALLBACK: pollingWaitCallback(); break;
        case CALLBACKS.REDIRECT_CALLBACK: redirectCallback(); break;
        case CALLBACKS.SCRIPT_TEXT_OUTPUT_CALLBACK: scriptTextOutputCallback(); break;
        case CALLBACKS.SELECT_IDP_CALLBACK: selectIdPCallback(); break;
        case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: stringAttributeInputCallback(); break;
        case CALLBACKS.SUSPENDED_TEXT_OUTPUT_CALLBACK: suspendedTextOutputCallback(); break;
        case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: termsAndConditionsCallback(); break;
        case CALLBACKS.TEXT_INPUT_CALLBACK: textInputCallback(); break;
        case CALLBACKS.TEXT_OUTPUT_CALLBACK: textOutputCallback(); break;
        case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: validatedPasswordCallback(); break;
        case CALLBACKS.VALIDATED_USERNAME_CALLBACK: validatedUsernameCallback(); break;
        case CALLBACKS.X509_CERTIFICATE_CALLBACK: x509CertificateCallback(); break;
        default: throw new Error('Unknown Callback'); // Should never reach this case
    }
}

main();
"
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Display-Callback.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "ef81b1a52c914710b3388caebfe7233a-1": {
      "_id": "ef81b1a52c914710b3388caebfe7233a-1",
      "description": "Displays custom callback to the page",
      "displayName": "Display Callback",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "callback": {
          "description": "The callback to display",
          "multivalued": false,
          "options": {
            "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK": "booleanAttributeInputCallback",
            "CHOICE_CALLBACK": "choiceCallback",
            "CONFIRMATION_CALLBACK": "confirmationCallback",
            "CONSENT_MAPPING_CALLBACK": "consentMappingCallback",
            "DEVICE_PROFILE_CALLBACK": "deviceProfileCallback",
            "HIDDEN_VALUE_CALLBACK": "hiddenValueCallback",
            "HTTP_CALLBACK": "httpCallback",
            "IDP_CALLBACK": "idPCallback",
            "KBA_CREATE_CALLBACK": "kbaCreateCallback",
            "LANGUAGE_CALLBACK": "languageCallback",
            "METADATA_CALLBACK": "metadataCallback",
            "NAME_CALLBACK": "nameCallback",
            "NUMBER_ATTRIBUTE_INPUT_CALLBACK": "numberAttributeInputCallback",
            "PASSWORD_CALLBACK": "passwordCallback",
            "POLLING_WAIT_CALLBACK": "pollingWaitCallback",
            "REDIRECT_CALLBACK": "redirectCallback",
            "SCRIPT_TEXT_OUTPUT_CALLBACK": "scriptTextOutputCallback",
            "SELECT_IDP_CALLBACK": "selectIdPCallback",
            "STRING_ATTRIBUTE_INPUT_CALLBACK": "stringAttributeInputCallback",
            "SUSPENDED_TEXT_OUTPUT_CALLBACK": "suspendedTextOutputCallback",
            "TERMS_AND_CONDITIONS_CALLBACK": "termsAndConditionsCallback",
            "TEXT_INPUT_CALLBACK": "textInputCallback",
            "TEXT_OUTPUT_CALLBACK": "textOutputCallback",
            "VALIDATED_PASSWORD_CALLBACK": "validatedPasswordCallback",
            "VALIDATED_USERNAME_CALLBACK": "validatedUsernameCallback",
            "X509_CERTIFICATE_CALLBACK": "x509CertificateCallback",
          },
          "required": true,
          "title": "Callback",
          "type": "STRING",
        },
        "objectSharedProperty": {
          "description": "The objectAttributes property on the shared state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Shared Property",
          "type": "STRING",
        },
        "objectTransientProperty": {
          "description": "The objectAttributes property on the transient state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Transient Property",
          "type": "STRING",
        },
        "options": {
          "description": "The options containing the parameters for the callback (see documentation for possible parameters: https://docs.pingidentity.com/pingoneaic/latest/am-scripting/scripting-api-node.html#scripting-api-node-callbacks). 

For example, for textOutputCallback, the options could be: { messageType: 0, message: "Hello World!" }. 

Note that for required parameters that are not specified in the options will use default values based on the type of the parameter ("" for Strings, [] for Arrays, {} for Objects, 0 for Ints, 0.0 for Doubles, and false for Booleans).",
          "multivalued": false,
          "required": true,
          "title": "Options",
          "type": "OBJECT",
        },
        "sharedProperty": {
          "description": "The shared state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Shared State Property",
          "type": "STRING",
        },
        "transientProperty": {
          "description": "The transient state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Transient State Property",
          "type": "STRING",
        },
      },
      "script": "file://Display-Callback.nodeTypes.js",
      "serviceName": "ef81b1a52c914710b3388caebfe7233a",
      "tags": [
        "callback",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Display-State.nodeTypes.js 1`] = `
"var SCRIPT_OUTCOMES = {
  OUTCOME: "outcome"
};

function main() {
    if (!callbacks.isEmpty()) {
        action.goTo(SCRIPT_OUTCOMES.OUTCOME);
        return;
    }
    var keySet = nodeState.keys(); // Java Set<String>
    var keys = Array.from(keySet); // Make it into JavaScript array
    debugState = {};
    for (var i in keys) {
        var k = new String(keys[i]);
        var item = nodeState.get(k);
        if (typeof item === "object") {
            debugState[k] = nodeState.getObject(k);
        } else {
            debugState[k] = nodeState.get(k);
        }
    }
    if (properties.displayFormat === "JSON") {
        callbacksBuilder.textOutputCallback(0, \`<pre style="text-align: left;">\${JSON.stringify(debugState, null, 2)}</pre>\`);
        return;
    }
    callbacksBuilder.textOutputCallback(0, \`<table><tr><td style="border: 1px solid black;">Key</td><td style="border: 1px solid black;">Value</td></tr>\${Array.from(Object.keys(debugState).map(k => \`<tr><td style="border: 1px solid black;"><pre style="text-align: left;">\${k}</pre></td><td style="border: 1px solid black;"><pre style="text-align: left;">\${debugState[k]}</pre></td></tr>\`))}</table>\`);
}

main();
"
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Display-State.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "8ab9f1aad4b4460a9c45d15fb148e221-1": {
      "_id": "8ab9f1aad4b4460a9c45d15fb148e221-1",
      "description": "Debug node that displays the shared and transient state of the journey for debugging purposes.",
      "displayName": "Display State",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "displayFormat": {
          "defaultValue": "TABLE",
          "description": "The format in which to display the states.",
          "multivalued": false,
          "options": {
            "JSON": "Raw JSON",
            "TABLE": "HTML Table",
          },
          "required": true,
          "title": "Display Format",
          "type": "STRING",
        },
      },
      "script": "file://Display-State.nodeTypes.js",
      "serviceName": "8ab9f1aad4b4460a9c45d15fb148e221",
      "tags": [
        "debug",
        "testing",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Generate-JWT.nodeTypes.js 1`] = `
"var aud = properties.audience;
var iss = properties.issuer;
var validity = properties.validity;
var esv = properties.signingkey;

var signingkey = systemEnv.getProperty(esv);

var username = nodeState.get("username");

var data = {
  jwtType:"SIGNED",
  jwsAlgorithm: "HS256",
  issuer: iss,
  subject: username,
  audience: aud,
  type: "JWT",
  validityMinutes: validity,
  signingKey: signingkey
};

var jwt = jwtAssertion.generateJwt(data);

if (jwt !== null && jwt.length > 0) {
  nodeState.putShared("assertionJwt" , jwt);
  action.goTo("True");
} else {
  action.goTo("False");
}
"
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Generate-JWT.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "e5ad0110c8ee4dafaae983003cd05d4a-1": {
      "_id": "e5ad0110c8ee4dafaae983003cd05d4a-1",
      "description": "Generate a signed JWT using the HMAC SHA-256 algorithm.",
      "displayName": "Generate JWT",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {
        "audience": {
          "description": "The audience (aud) claim",
          "multivalued": false,
          "required": true,
          "title": "Audience",
          "type": "STRING",
        },
        "issuer": {
          "description": "The issuer (iss) claim",
          "multivalued": false,
          "required": true,
          "title": "Issuer",
          "type": "STRING",
        },
        "signingkey": {
          "defaultValue": "esv.signing.key",
          "description": "The secret label for the HMAC signing key",
          "multivalued": false,
          "required": true,
          "title": "HMAC Signing Key",
          "type": "STRING",
        },
        "validity": {
          "defaultValue": 5,
          "description": "",
          "multivalued": false,
          "required": true,
          "title": "Validity (minutes)",
          "type": "NUMBER",
        },
      },
      "script": "file://Generate-JWT.nodeTypes.js",
      "serviceName": "e5ad0110c8ee4dafaae983003cd05d4a",
      "tags": [
        "Utilities",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Has-Session.nodeTypes.js 1`] = `
"var SCRIPT_OUTCOMES = {
    TRUE: 'True',
    FALSE: 'False'
}

function main() {
    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);
}

main();
"
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Has-Session.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "c605506774a848f7877b4d17a453bd39-1": {
      "_id": "c605506774a848f7877b4d17a453bd39-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "file://Has-Session.nodeTypes.js",
      "serviceName": "c605506774a848f7877b4d17a453bd39",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Has-Session-AM.nodeTypes.js 1`] = `
"var SCRIPT_OUTCOMES = {
    TRUE: 'True',
    FALSE: 'False'
}

function main() {
    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);
}

main();
"
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Has-Session-AM.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "session-1": {
      "_id": "session-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session AM",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "file://Has-Session-AM.nodeTypes.js",
      "serviceName": "session",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Vector-ALU.nodeTypes.js 1`] = `
"var SCRIPT_OUTCOMES = {
    SUCCESS: 'Success'
};

var OPERATORS = {
    ADD: "ADD",
    SUBTRACT: "SUBTRACT",
    DOT: "DOT",
    CROSS: "CROSS"
}

function add(a, b) {
    return a.map((v, i) => v + b[i]);
}

function subtract(a, b) {
    return a.map((v, i) => v - b[i]);
}

function dot(a, b) {
    return a.reduce((sum, v, i) => sum + v * b[i], 0);
}

function cross(a, b) {
    return [
        a[1] * b[2] - a[2] * b[1],
        a[2] * b[0] - a[0] * b[2],
        a[0] * b[1] - a[1] * b[0]
    ];
}

function main() {
    if (properties.a.length !== properties.b.length) throw new Error("Vectors not the same dimension.");
    switch (properties.operator) {
        case OPERATORS.ADD:
            nodeState.putShared("c", add(properties.a, properties.b));
            break;
        case OPERATORS.SUBTRACT:
            nodeState.putShared("c", subtract(properties.a, properties.b));
            break;
        case OPERATORS.DOT:
            nodeState.putShared("c", dot(properties.a, properties.b));
            break;
        case OPERATORS.CROSS:
            if (properties.a.length !== 3) throw new Error("Vectors not dimension 3 for cross product");
            nodeState.putShared("c", cross(properties.a, properties.b));
            break;
        default: throw new Error("Unknown operator.");
    }
    action.goTo(SCRIPT_OUTCOMES.SUCCESS);
}

main();
"
`;

exports[`frodo node export "frodo node export --all-separate --extract --directory customNodeExportDir5 --use-string-arrays": should export all nodes with extracted scripts into separate files in the directory customNodeExportDir5: customNodeExportDir5/Vector-ALU.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "c15e2efb3deb4d4ea338c74a6440b69f-1": {
      "_id": "c15e2efb3deb4d4ea338c74a6440b69f-1",
      "description": "Simple ALU that performs basic binary vector math operations. Outputs the result onto the shared state with key "c".",
      "displayName": "Vector ALU",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "c",
      ],
      "properties": {
        "a": {
          "defaultValue": [
            1,
            2,
            3,
          ],
          "description": "Left vector operand",
          "multivalued": true,
          "required": true,
          "title": "A",
          "type": "NUMBER",
        },
        "b": {
          "defaultValue": [
            4,
            5,
            6,
          ],
          "description": "Right vector operand",
          "multivalued": true,
          "required": true,
          "title": "B",
          "type": "NUMBER",
        },
        "operator": {
          "defaultValue": "DOT",
          "description": "The binary operation to perform on the vectors.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "CROSS": "X",
            "DOT": ".",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": "file://Vector-ALU.nodeTypes.js",
      "serviceName": "c15e2efb3deb4d4ea338c74a6440b69f",
      "tags": [
        "math",
        "vector",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --node-id c605506774a848f7877b4d17a453bd39-1": should export the custom node with id "c605506774a848f7877b4d17a453bd39-1" 1`] = `0`;

exports[`frodo node export "frodo node export --node-id c605506774a848f7877b4d17a453bd39-1": should export the custom node with id "c605506774a848f7877b4d17a453bd39-1" 2`] = `""`;

exports[`frodo node export "frodo node export --node-id c605506774a848f7877b4d17a453bd39-1": should export the custom node with id "c605506774a848f7877b4d17a453bd39-1": c605506774a848f7877b4d17a453bd39-1.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "c605506774a848f7877b4d17a453bd39-1": {
      "_id": "c605506774a848f7877b4d17a453bd39-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "var SCRIPT_OUTCOMES = {
    TRUE: 'True',
    FALSE: 'False'
}

function main() {
    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);
}

main();
",
      "serviceName": "c605506774a848f7877b4d17a453bd39",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export --node-name 'Display Callback' --use-string-arrays": should export the custom node with display name "DisplayCallback" 1`] = `0`;

exports[`frodo node export "frodo node export --node-name 'Display Callback' --use-string-arrays": should export the custom node with display name "DisplayCallback" 2`] = `""`;

exports[`frodo node export "frodo node export --node-name 'Display Callback' --use-string-arrays": should export the custom node with display name "DisplayCallback": Display-Callback.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "ef81b1a52c914710b3388caebfe7233a-1": {
      "_id": "ef81b1a52c914710b3388caebfe7233a-1",
      "description": "Displays custom callback to the page",
      "displayName": "Display Callback",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "callback": {
          "description": "The callback to display",
          "multivalued": false,
          "options": {
            "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK": "booleanAttributeInputCallback",
            "CHOICE_CALLBACK": "choiceCallback",
            "CONFIRMATION_CALLBACK": "confirmationCallback",
            "CONSENT_MAPPING_CALLBACK": "consentMappingCallback",
            "DEVICE_PROFILE_CALLBACK": "deviceProfileCallback",
            "HIDDEN_VALUE_CALLBACK": "hiddenValueCallback",
            "HTTP_CALLBACK": "httpCallback",
            "IDP_CALLBACK": "idPCallback",
            "KBA_CREATE_CALLBACK": "kbaCreateCallback",
            "LANGUAGE_CALLBACK": "languageCallback",
            "METADATA_CALLBACK": "metadataCallback",
            "NAME_CALLBACK": "nameCallback",
            "NUMBER_ATTRIBUTE_INPUT_CALLBACK": "numberAttributeInputCallback",
            "PASSWORD_CALLBACK": "passwordCallback",
            "POLLING_WAIT_CALLBACK": "pollingWaitCallback",
            "REDIRECT_CALLBACK": "redirectCallback",
            "SCRIPT_TEXT_OUTPUT_CALLBACK": "scriptTextOutputCallback",
            "SELECT_IDP_CALLBACK": "selectIdPCallback",
            "STRING_ATTRIBUTE_INPUT_CALLBACK": "stringAttributeInputCallback",
            "SUSPENDED_TEXT_OUTPUT_CALLBACK": "suspendedTextOutputCallback",
            "TERMS_AND_CONDITIONS_CALLBACK": "termsAndConditionsCallback",
            "TEXT_INPUT_CALLBACK": "textInputCallback",
            "TEXT_OUTPUT_CALLBACK": "textOutputCallback",
            "VALIDATED_PASSWORD_CALLBACK": "validatedPasswordCallback",
            "VALIDATED_USERNAME_CALLBACK": "validatedUsernameCallback",
            "X509_CERTIFICATE_CALLBACK": "x509CertificateCallback",
          },
          "required": true,
          "title": "Callback",
          "type": "STRING",
        },
        "objectSharedProperty": {
          "description": "The objectAttributes property on the shared state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Shared Property",
          "type": "STRING",
        },
        "objectTransientProperty": {
          "description": "The objectAttributes property on the transient state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Transient Property",
          "type": "STRING",
        },
        "options": {
          "description": "The options containing the parameters for the callback (see documentation for possible parameters: https://docs.pingidentity.com/pingoneaic/latest/am-scripting/scripting-api-node.html#scripting-api-node-callbacks). 

For example, for textOutputCallback, the options could be: { messageType: 0, message: "Hello World!" }. 

Note that for required parameters that are not specified in the options will use default values based on the type of the parameter ("" for Strings, [] for Arrays, {} for Objects, 0 for Ints, 0.0 for Doubles, and false for Booleans).",
          "multivalued": false,
          "required": true,
          "title": "Options",
          "type": "OBJECT",
        },
        "sharedProperty": {
          "description": "The shared state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Shared State Property",
          "type": "STRING",
        },
        "transientProperty": {
          "description": "The transient state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Transient State Property",
          "type": "STRING",
        },
      },
      "script": [
        "var SCRIPT_OUTCOMES = {",
        "    OUTCOME: 'outcome'",
        "};",
        "",
        "var CALLBACKS = {",
        "	BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK",",
        "	CHOICE_CALLBACK: "CHOICE_CALLBACK",",
        "	CONFIRMATION_CALLBACK: "CONFIRMATION_CALLBACK",",
        "	CONSENT_MAPPING_CALLBACK: "CONSENT_MAPPING_CALLBACK",",
        "	DEVICE_PROFILE_CALLBACK: "DEVICE_PROFILE_CALLBACK",",
        "	HIDDEN_VALUE_CALLBACK: "HIDDEN_VALUE_CALLBACK",",
        "	HTTP_CALLBACK: "HTTP_CALLBACK",",
        "	IDP_CALLBACK: "IDP_CALLBACK",",
        "	KBA_CREATE_CALLBACK: "KBA_CREATE_CALLBACK",",
        "	LANGUAGE_CALLBACK: "LANGUAGE_CALLBACK",",
        "	METADATA_CALLBACK: "METADATA_CALLBACK",",
        "	NAME_CALLBACK: "NAME_CALLBACK",",
        "	NUMBER_ATTRIBUTE_INPUT_CALLBACK: "NUMBER_ATTRIBUTE_INPUT_CALLBACK",",
        "	PASSWORD_CALLBACK: "PASSWORD_CALLBACK",",
        "	POLLING_WAIT_CALLBACK: "POLLING_WAIT_CALLBACK",",
        "    REDIRECT_CALLBACK: "REDIRECT_CALLBACK",",
        "	SCRIPT_TEXT_OUTPUT_CALLBACK: "SCRIPT_TEXT_OUTPUT_CALLBACK",",
        "	SELECT_IDP_CALLBACK: "SELECT_IDP_CALLBACK",",
        "	STRING_ATTRIBUTE_INPUT_CALLBACK: "STRING_ATTRIBUTE_INPUT_CALLBACK",",
        "	SUSPENDED_TEXT_OUTPUT_CALLBACK: "SUSPENDED_TEXT_OUTPUT_CALLBACK",",
        "	TERMS_AND_CONDITIONS_CALLBACK: "TERMS_AND_CONDITIONS_CALLBACK",",
        "	TEXT_INPUT_CALLBACK: "TEXT_INPUT_CALLBACK",",
        "	TEXT_OUTPUT_CALLBACK: "TEXT_OUTPUT_CALLBACK",",
        "	VALIDATED_PASSWORD_CALLBACK: "VALIDATED_PASSWORD_CALLBACK",",
        "	VALIDATED_USERNAME_CALLBACK: "VALIDATED_USERNAME_CALLBACK",",
        "	X509_CERTIFICATE_CALLBACK: "X509_CERTIFICATE_CALLBACK"",
        "}",
        "",
        "function isStringPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getString(value) {",
        "    return value || '';",
        "}",
        "",
        "function isArrayPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getArray(value) {",
        "    return value ? JSON.parse(value) : [];",
        "}",
        "",
        "function isObjectPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getObject(value) {",
        "    return value ? JSON.parse(value) : {};",
        "}",
        "",
        "function isIntPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getInt(value) {",
        "    return value ? parseInt(value) : 0;",
        "}",
        "",
        "function isDoublePresent(value) {",
        "    return value;",
        "}",
        "",
        "function getDouble(value) {",
        "    return value ? parseFloat(value) : 0.0;",
        "}",
        "",
        "function isBooleanPresent(value) {",
        "    return value;",
        "}",
        "",
        "function getBoolean(value) {",
        "    return value ? value.toLowerCase() === 'true' : false;",
        "}",
        "",
        "function setProperty(value) {",
        "    if (properties.sharedProperty) nodeState.putShared(properties.sharedProperty, value);",
        "    if (properties.transientProperty) nodeState.putTransient(properties.transientProperty, value);",
        "    if (properties.objectSharedProperty) {",
        "        var attributes = {};",
        "        attributes[properties.objectSharedProperty] = value;",
        "        nodeState.mergeShared({",
        "            objectAttributes: attributes",
        "        });",
        "    }",
        "    if (properties.objectTransientProperty) {",
        "        var attributes = {};",
        "        attributes[properties.objectTransientProperty] = value;",
        "        nodeState.mergeTransient({",
        "            objectAttributes: attributes",
        "        });",
        "    }",
        "}",
        "",
        "function booleanAttributeInputCallback() {",
        "    var name = getString(properties.options.name);",
        "    var prompt = getString(properties.options.prompt);",
        "    var value = getBoolean(properties.options.value);",
        "    var required = getBoolean(properties.options.required);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {",
        "        if (isArrayPresent(failedPolicies)) {",
        "            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);",
        "        } else {",
        "            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly);",
        "        }",
        "    } else if (isArrayPresent(failedPolicies)) {",
        "        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required);",
        "    }",
        "}",
        "",
        "function choiceCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var choices = getArray(properties.options.choices);",
        "    var defaultChoice = getInt(properties.options.defaultChoice);",
        "    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);",
        "    callbacksBuilder.choiceCallback(prompt, choices, defaultChoice, multipleSelectionsAllowed);",
        "}",
        "",
        "function confirmationCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var messageType = getInt(properties.options.messageType);",
        "    var options = getArray(properties.options.options);",
        "    var optionType = getInt(properties.options.optionType);",
        "    var defaultOption = getInt(properties.options.defaultOption);",
        "    if (isStringPresent(properties.options.prompt)) {",
        "        if (isIntPresent(properties.options.optionType)) {",
        "            callbacksBuilder.confirmationCallback(prompt, messageType, optionType, defaultOption);",
        "        } else {",
        "            callbacksBuilder.confirmationCallback(prompt, messageType, options, defaultOption);",
        "        }",
        "    } else {",
        "        if (isIntPresent(properties.options.optionType)) {",
        "            callbacksBuilder.confirmationCallback(messageType, optionType, defaultOption);",
        "        } else {",
        "            callbacksBuilder.confirmationCallback(messageType, options, defaultOption);",
        "        }",
        "    }",
        "}",
        "",
        "function consentMappingCallback() {",
        "    var config = getObject(properties.options.config);",
        "    var message = getString(properties.options.message);",
        "    var isRequired = getBoolean(properties.options.isRequired);",
        "    var name = getString(properties.options.name);",
        "    var displayName = getString(properties.options.displayName);",
        "    var icon = getString(properties.options.icon);",
        "    var accessLevel = getString(properties.options.accessLevel);",
        "    var titles = getArray(properties.options.titles);",
        "    if (isObjectPresent(properties.options.prompt)) {",
        "        callbacksBuilder.consentMappingCallback(config, message, isRequired);",
        "    } else {",
        "        callbacksBuilder.consentMappingCallback(name, displayName, icon, accessLevel, titles, message, isRequired);",
        "    }",
        "}",
        "",
        "function deviceProfileCallback() {",
        "    var metadata = getBoolean(properties.options.metadata);",
        "    var location = getBoolean(properties.options.location);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.deviceProfileCallback(metadata, location, message);",
        "}",
        "",
        "function hiddenValueCallback() {",
        "    var id = getString(properties.options.id);",
        "    var value = getString(properties.options.value);",
        "    callbacksBuilder.hiddenValueCallback(id, value);",
        "}",
        "",
        "function httpCallback() {",
        "    var authorizationHeader = getString(properties.options.authorizationHeader);",
        "    var negotiationHeader = getString(properties.options.negotiationHeader);",
        "    var authRHeader = getString(properties.options.authRHeader);",
        "    var negoName = getString(properties.options.negoName);",
        "    var negoValue = getString(properties.options.negoValue);",
        "    if (isStringPresent(properties.options.authorizationHeader) || isStringPresent(properties.options.negotiationHeader)) {",
        "        var errorCode = getString(properties.options.errorCode);",
        "        callbacksBuilder.httpCallback(authorizationHeader, negotiationHeader, errorCode);",
        "    } else {",
        "        var errorCode = getInt(properties.options.errorCode);",
        "        callbacksBuilder.httpCallback(authRHeader, negoName, negoValue, errorCode);",
        "    }",
        "}",
        "",
        "function idPCallback() {",
        "    var provider = getString(properties.options.provider);",
        "    var clientId = getString(properties.options.clientId);",
        "    var redirectUri = getString(properties.options.redirectUri);",
        "    var scope = getArray(properties.options.scope);",
        "    var nonce = getString(properties.options.nonce);",
        "    var request = getString(properties.options.request);",
        "    var requestUri = getString(properties.options.requestUri);",
        "    var acrValues = getArray(properties.options.acrValues);",
        "    var requestNativeAppForUserInfo = getBoolean(properties.options.requestNativeAppForUserInfo);",
        "    var token = getString(properties.options.token);",
        "    var tokenType = getString(properties.options.tokenType);",
        "    if (isStringPresent(properties.options.token) || isStringPresent(properties.options.tokenType)) {",
        "        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo, token, tokenType);",
        "    } else {",
        "        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo);",
        "    }",
        "}",
        "",
        "function kbaCreateCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var predefinedQuestions = getArray(properties.options.predefinedQuestions);",
        "    var allowUserDefinedQuestions = getBoolean(properties.options.allowUserDefinedQuestions);",
        "    callbacksBuilder.kbaCreateCallback(prompt, predefinedQuestions, allowUserDefinedQuestions);",
        "}",
        "",
        "function languageCallback() {",
        "    var language = getString(properties.options.language);",
        "    var country = getString(properties.options.country);",
        "    callbacksBuilder.languageCallback(language, country);",
        "}",
        "",
        "function metadataCallback() {",
        "    var outputValue = getObject(properties.options.outputValue);",
        "    callbacksBuilder.metadataCallback(outputValue);",
        "}",
        "",
        "function nameCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var defaultName = getString(properties.options.defaultName);",
        "    if (isStringPresent(properties.options.defaultName)) {",
        "        callbacksBuilder.nameCallback(prompt, defaultName);",
        "    } else {",
        "        callbacksBuilder.nameCallback(prompt);",
        "    }",
        "}",
        "",
        "function numberAttributeInputCallback() {",
        "    var name = getString(properties.options.name);",
        "    var prompt = getString(properties.options.prompt);",
        "    var value = getDouble(properties.options.value);",
        "    var required = getBoolean(properties.options.required);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {",
        "        if (isArrayPresent(failedPolicies)) {",
        "            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);",
        "        } else {",
        "            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly);",
        "        }",
        "    } else if (isArrayPresent(failedPolicies)) {",
        "        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required);",
        "    }",
        "}",
        "",
        "function passwordCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var echoOn = getBoolean(properties.options.echoOn);",
        "    callbacksBuilder.passwordCallback(prompt, echoOn);",
        "}",
        "",
        "function pollingWaitCallback() {",
        "    var waitTime = getString(properties.options.waitTime);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.pollingWaitCallback(waitTime, message);",
        "}",
        "",
        "function redirectCallback() {",
        "    throw new Error('Not Implemented');",
        "}",
        "",
        "function scriptTextOutputCallback() {",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.scriptTextOutputCallback(message);",
        "}",
        "",
        "function selectIdPCallback() {",
        "    var providers = getObject(properties.options.providers);",
        "    callbacksBuilder.selectIdPCallback(providers);",
        "}",
        "",
        "function stringAttributeInputCallback() {",
        "    var name = getString(properties.options.name);",
        "    var prompt = getString(properties.options.prompt);",
        "    var value = getString(properties.options.value);",
        "    var required = getBoolean(properties.options.required);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {",
        "        if (isArrayPresent(failedPolicies)) {",
        "            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);",
        "        } else {",
        "            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly);",
        "        }",
        "    } else if (isArrayPresent(failedPolicies)) {",
        "        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required);",
        "    }",
        "}",
        "",
        "function suspendedTextOutputCallback() {",
        "    var messageType = getInt(properties.options.messageType);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.suspendedTextOutputCallback(messageType, message);",
        "}",
        "",
        "function termsAndConditionsCallback() {",
        "    var version = getString(properties.options.version);",
        "    var terms = getString(properties.options.terms);",
        "    var createDate = getString(properties.options.createDate);",
        "    callbacksBuilder.termsAndConditionsCallback(version, terms, createDate);",
        "}",
        "",
        "function textInputCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var defaultText = getString(properties.options.defaultText);",
        "    if (isStringPresent(properties.options.defaultText)) {",
        "        callbacksBuilder.textInputCallback(prompt, defaultText);",
        "    } else {",
        "        callbacksBuilder.textInputCallback(prompt);",
        "    }",
        "}",
        "",
        "function textOutputCallback() {",
        "    var messageType = getString(properties.options.messageType);",
        "    var message = getString(properties.options.message);",
        "    callbacksBuilder.textOutputCallback(messageType, message);",
        "}",
        "",
        "function validatedPasswordCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var echoOn = getBoolean(properties.options.echoOn);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isArrayPresent(properties.options.failedPolicies)) {",
        "        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly);",
        "    }",
        "}",
        "",
        "function validatedUsernameCallback() {",
        "    var prompt = getString(properties.options.prompt);",
        "    var policies = getObject(properties.options.policies);",
        "    var validateOnly = getBoolean(properties.options.validateOnly);",
        "    var failedPolicies = getArray(properties.options.failedPolicies);",
        "    if (isArrayPresent(properties.options.failedPolicies)) {",
        "        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly, failedPolicies);",
        "    } else {",
        "        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly);",
        "    }",
        "}",
        "",
        "function x509CertificateCallback() {",
        "    throw new Error('Not Implemented');",
        "}",
        "",
        "function getBooleanAttributeInputCallback() {",
        "    setProperty(callbacks.getBooleanAttributeInputCallbacks().get(0));",
        "}",
        "",
        "function getChoiceCallback() {",
        "    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);",
        "    var selections = callbacks.getChoiceCallbacks().get(0);",
        "    setProperty(multipleSelectionsAllowed ? selections : selections[0]);",
        "}",
        "",
        "function getConfirmationCallback() {",
        "    setProperty(callbacks.getConfirmationCallbacks().get(0));",
        "}",
        "",
        "function getConsentMappingCallback() {",
        "    setProperty(callbacks.getConsentMappingCallbacks().get(0));",
        "}",
        "",
        "function getDeviceProfileCallback() {",
        "    setProperty(callbacks.getDeviceProfileCallbacks().get(0));",
        "}",
        "",
        "function getHiddenValueCallback() {",
        "    var id = getString(properties.options.id);",
        "    setProperty(callbacks.getHiddenValueCallbacks().get(id));",
        "}",
        "",
        "function getHttpCallback() {",
        "    setProperty(callbacks.getHttpCallbacks().get(0));",
        "}",
        "",
        "function getIdPCallback() {",
        "    setProperty(callbacks.getIdpCallbacks().get(0));",
        "}",
        "",
        "function getKbaCreateCallback() {",
        "    setProperty(callbacks.getKbaCreateCallbacks().get(0));",
        "}",
        "",
        "function getLanguageCallback() {",
        "    setProperty(callbacks.getLanguageCallbacks().get(0));",
        "}",
        "",
        "function getNameCallback() {",
        "    setProperty(callbacks.getNameCallbacks().get(0));",
        "}",
        "",
        "function getNumberAttributeInputCallback() {",
        "    setProperty(callbacks.getNumberAttributeInputCallbacks().get(0));",
        "}",
        "",
        "function getPasswordCallback() {",
        "    setProperty(callbacks.getPasswordCallbacks().get(0));",
        "}",
        "",
        "function getSelectIdPCallback() {",
        "    setProperty(callbacks.getSelectIdPCallbacks().get(0));",
        "}",
        "",
        "function getStringAttributeInputCallback() {",
        "    setProperty(callbacks.getStringAttributeInputCallbacks().get(0));",
        "}",
        "",
        "function getTermsAndConditionsCallback() {",
        "    setProperty(callbacks.getTermsAndConditionsCallbacks().get(0));",
        "}",
        "",
        "function getTextInputCallback() {",
        "    setProperty(callbacks.getTextInputCallbacks().get(0));",
        "}",
        "",
        "function getValidatedPasswordCallback() {",
        "    setProperty(callbacks.getValidatedPasswordCallbacks().get(0));",
        "}",
        "",
        "function getValidatedUsernameCallback() {",
        "    setProperty(callbacks.getValidatedUsernameCallbacks().get(0));",
        "}",
        "",
        "function getX509CertificateCallback() {",
        "    setProperty(callbacks.getX509CertificateCallbacks().get(0));",
        "}",
        "",
        "function main() {",
        "    if (!callbacks.isEmpty()) {",
        "        switch (properties.callback) {",
        "            case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: getBooleanAttributeInputCallback(); break;",
        "            case CALLBACKS.CHOICE_CALLBACK: getChoiceCallback(); break;",
        "            case CALLBACKS.CONFIRMATION_CALLBACK: getConfirmationCallback(); break;",
        "            case CALLBACKS.CONSENT_MAPPING_CALLBACK: getConsentMappingCallback(); break;",
        "            case CALLBACKS.DEVICE_PROFILE_CALLBACK: getDeviceProfileCallback(); break;",
        "            case CALLBACKS.HIDDEN_VALUE_CALLBACK: getHiddenValueCallback(); break;",
        "            case CALLBACKS.HTTP_CALLBACK: getHttpCallback(); break;",
        "            case CALLBACKS.IDP_CALLBACK: getIdPCallback(); break;",
        "            case CALLBACKS.KBA_CREATE_CALLBACK: getKbaCreateCallback(); break;",
        "            case CALLBACKS.LANGUAGE_CALLBACK: getLanguageCallback(); break;",
        "            case CALLBACKS.NAME_CALLBACK: getNameCallback(); break;",
        "            case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: getNumberAttributeInputCallback(); break;",
        "            case CALLBACKS.PASSWORD_CALLBACK: getPasswordCallback(); break;",
        "            case CALLBACKS.SELECT_IDP_CALLBACK: getSelectIdPCallback(); break;",
        "            case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: getStringAttributeInputCallback(); break;",
        "            case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: getTermsAndConditionsCallback(); break;",
        "            case CALLBACKS.TEXT_INPUT_CALLBACK: getTextInputCallback(); break;",
        "            case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: getValidatedPasswordCallback(); break;",
        "            case CALLBACKS.VALIDATED_USERNAME_CALLBACK: getValidatedUsernameCallback(); break;",
        "            case CALLBACKS.X509_CERTIFICATE_CALLBACK: getX509CertificateCallback(); break;",
        "            default: break;",
        "        }",
        "        action.goTo(SCRIPT_OUTCOMES.OUTCOME);",
        "        return;",
        "    }",
        "",
        "    switch (properties.callback) {",
        "        case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: booleanAttributeInputCallback(); break;",
        "        case CALLBACKS.CHOICE_CALLBACK: choiceCallback(); break;",
        "        case CALLBACKS.CONFIRMATION_CALLBACK: confirmationCallback(); break;",
        "        case CALLBACKS.CONSENT_MAPPING_CALLBACK: consentMappingCallback(); break;",
        "        case CALLBACKS.DEVICE_PROFILE_CALLBACK: deviceProfileCallback(); break;",
        "        case CALLBACKS.HIDDEN_VALUE_CALLBACK: hiddenValueCallback(); break;",
        "        case CALLBACKS.HTTP_CALLBACK: httpCallback(); break;",
        "        case CALLBACKS.IDP_CALLBACK: idPCallback(); break;",
        "        case CALLBACKS.KBA_CREATE_CALLBACK: kbaCreateCallback(); break;",
        "        case CALLBACKS.LANGUAGE_CALLBACK: languageCallback(); break;",
        "        case CALLBACKS.METADATA_CALLBACK: metadataCallback(); break;",
        "        case CALLBACKS.NAME_CALLBACK: nameCallback(); break;",
        "        case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: numberAttributeInputCallback(); break;",
        "        case CALLBACKS.PASSWORD_CALLBACK: passwordCallback(); break;",
        "        case CALLBACKS.POLLING_WAIT_CALLBACK: pollingWaitCallback(); break;",
        "        case CALLBACKS.REDIRECT_CALLBACK: redirectCallback(); break;",
        "        case CALLBACKS.SCRIPT_TEXT_OUTPUT_CALLBACK: scriptTextOutputCallback(); break;",
        "        case CALLBACKS.SELECT_IDP_CALLBACK: selectIdPCallback(); break;",
        "        case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: stringAttributeInputCallback(); break;",
        "        case CALLBACKS.SUSPENDED_TEXT_OUTPUT_CALLBACK: suspendedTextOutputCallback(); break;",
        "        case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: termsAndConditionsCallback(); break;",
        "        case CALLBACKS.TEXT_INPUT_CALLBACK: textInputCallback(); break;",
        "        case CALLBACKS.TEXT_OUTPUT_CALLBACK: textOutputCallback(); break;",
        "        case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: validatedPasswordCallback(); break;",
        "        case CALLBACKS.VALIDATED_USERNAME_CALLBACK: validatedUsernameCallback(); break;",
        "        case CALLBACKS.X509_CERTIFICATE_CALLBACK: x509CertificateCallback(); break;",
        "        default: throw new Error('Unknown Callback'); // Should never reach this case",
        "    }",
        "}",
        "",
        "main();",
        "",
      ],
      "serviceName": "ef81b1a52c914710b3388caebfe7233a",
      "tags": [
        "callback",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4 1`] = `0`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4 2`] = `""`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4: customNodeExportDir4/ALU.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "c6063fb2f5dc42dd9772bedc93898bd8-1": {
      "_id": "c6063fb2f5dc42dd9772bedc93898bd8-1",
      "description": "Simple ALU that performs basic binary math operations. Expects an "x" and "y" value on the shared state, and will produce a new "z" value on the shared state as output.",
      "displayName": "ALU",
      "errorOutcome": true,
      "inputs": [
        "x",
        "y",
      ],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "z",
      ],
      "properties": {
        "operator": {
          "defaultValue": "ADD",
          "description": "The operation to perform.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "DIVIDE": "/",
            "MULTIPLY": "*",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
    SUCCESS: 'Success'
};

var OPERATORS = {
    ADD: "ADD",
    SUBTRACT: "SUBTRACT",
    MULTIPLY: "MULTIPLY",
    DIVIDE: "DIVIDE"
}

function main() {
    var a = Number(properties.a);
    var b = Number(properties.b);
    switch (properties.operator) {
        case OPERATORS.ADD:
            nodeState.putShared("z", a + b);
            break;
        case OPERATORS.SUBTRACT:
            nodeState.putShared("z", a - b);
            break;
        case OPERATORS.MULTIPLY:
            nodeState.putShared("z", a * b);
            break;
        case OPERATORS.DIVIDE:
            if (b == 0) throw new Error("Cannot divide by 0");
            nodeState.putShared("z", a / b);
            break;
        default: throw new Error("Unknown operator.");
    }
    action.goTo(SCRIPT_OUTCOMES.SUCCESS);
}

main();
",
      "serviceName": "c6063fb2f5dc42dd9772bedc93898bd8",
      "tags": [
        "math",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4: customNodeExportDir4/Display-Callback.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "ef81b1a52c914710b3388caebfe7233a-1": {
      "_id": "ef81b1a52c914710b3388caebfe7233a-1",
      "description": "Displays custom callback to the page",
      "displayName": "Display Callback",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "callback": {
          "description": "The callback to display",
          "multivalued": false,
          "options": {
            "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK": "booleanAttributeInputCallback",
            "CHOICE_CALLBACK": "choiceCallback",
            "CONFIRMATION_CALLBACK": "confirmationCallback",
            "CONSENT_MAPPING_CALLBACK": "consentMappingCallback",
            "DEVICE_PROFILE_CALLBACK": "deviceProfileCallback",
            "HIDDEN_VALUE_CALLBACK": "hiddenValueCallback",
            "HTTP_CALLBACK": "httpCallback",
            "IDP_CALLBACK": "idPCallback",
            "KBA_CREATE_CALLBACK": "kbaCreateCallback",
            "LANGUAGE_CALLBACK": "languageCallback",
            "METADATA_CALLBACK": "metadataCallback",
            "NAME_CALLBACK": "nameCallback",
            "NUMBER_ATTRIBUTE_INPUT_CALLBACK": "numberAttributeInputCallback",
            "PASSWORD_CALLBACK": "passwordCallback",
            "POLLING_WAIT_CALLBACK": "pollingWaitCallback",
            "REDIRECT_CALLBACK": "redirectCallback",
            "SCRIPT_TEXT_OUTPUT_CALLBACK": "scriptTextOutputCallback",
            "SELECT_IDP_CALLBACK": "selectIdPCallback",
            "STRING_ATTRIBUTE_INPUT_CALLBACK": "stringAttributeInputCallback",
            "SUSPENDED_TEXT_OUTPUT_CALLBACK": "suspendedTextOutputCallback",
            "TERMS_AND_CONDITIONS_CALLBACK": "termsAndConditionsCallback",
            "TEXT_INPUT_CALLBACK": "textInputCallback",
            "TEXT_OUTPUT_CALLBACK": "textOutputCallback",
            "VALIDATED_PASSWORD_CALLBACK": "validatedPasswordCallback",
            "VALIDATED_USERNAME_CALLBACK": "validatedUsernameCallback",
            "X509_CERTIFICATE_CALLBACK": "x509CertificateCallback",
          },
          "required": true,
          "title": "Callback",
          "type": "STRING",
        },
        "objectSharedProperty": {
          "description": "The objectAttributes property on the shared state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Shared Property",
          "type": "STRING",
        },
        "objectTransientProperty": {
          "description": "The objectAttributes property on the transient state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Transient Property",
          "type": "STRING",
        },
        "options": {
          "description": "The options containing the parameters for the callback (see documentation for possible parameters: https://docs.pingidentity.com/pingoneaic/latest/am-scripting/scripting-api-node.html#scripting-api-node-callbacks). 

For example, for textOutputCallback, the options could be: { messageType: 0, message: "Hello World!" }. 

Note that for required parameters that are not specified in the options will use default values based on the type of the parameter ("" for Strings, [] for Arrays, {} for Objects, 0 for Ints, 0.0 for Doubles, and false for Booleans).",
          "multivalued": false,
          "required": true,
          "title": "Options",
          "type": "OBJECT",
        },
        "sharedProperty": {
          "description": "The shared state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Shared State Property",
          "type": "STRING",
        },
        "transientProperty": {
          "description": "The transient state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Transient State Property",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
    OUTCOME: 'outcome'
};

var CALLBACKS = {
	BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK",
	CHOICE_CALLBACK: "CHOICE_CALLBACK",
	CONFIRMATION_CALLBACK: "CONFIRMATION_CALLBACK",
	CONSENT_MAPPING_CALLBACK: "CONSENT_MAPPING_CALLBACK",
	DEVICE_PROFILE_CALLBACK: "DEVICE_PROFILE_CALLBACK",
	HIDDEN_VALUE_CALLBACK: "HIDDEN_VALUE_CALLBACK",
	HTTP_CALLBACK: "HTTP_CALLBACK",
	IDP_CALLBACK: "IDP_CALLBACK",
	KBA_CREATE_CALLBACK: "KBA_CREATE_CALLBACK",
	LANGUAGE_CALLBACK: "LANGUAGE_CALLBACK",
	METADATA_CALLBACK: "METADATA_CALLBACK",
	NAME_CALLBACK: "NAME_CALLBACK",
	NUMBER_ATTRIBUTE_INPUT_CALLBACK: "NUMBER_ATTRIBUTE_INPUT_CALLBACK",
	PASSWORD_CALLBACK: "PASSWORD_CALLBACK",
	POLLING_WAIT_CALLBACK: "POLLING_WAIT_CALLBACK",
    REDIRECT_CALLBACK: "REDIRECT_CALLBACK",
	SCRIPT_TEXT_OUTPUT_CALLBACK: "SCRIPT_TEXT_OUTPUT_CALLBACK",
	SELECT_IDP_CALLBACK: "SELECT_IDP_CALLBACK",
	STRING_ATTRIBUTE_INPUT_CALLBACK: "STRING_ATTRIBUTE_INPUT_CALLBACK",
	SUSPENDED_TEXT_OUTPUT_CALLBACK: "SUSPENDED_TEXT_OUTPUT_CALLBACK",
	TERMS_AND_CONDITIONS_CALLBACK: "TERMS_AND_CONDITIONS_CALLBACK",
	TEXT_INPUT_CALLBACK: "TEXT_INPUT_CALLBACK",
	TEXT_OUTPUT_CALLBACK: "TEXT_OUTPUT_CALLBACK",
	VALIDATED_PASSWORD_CALLBACK: "VALIDATED_PASSWORD_CALLBACK",
	VALIDATED_USERNAME_CALLBACK: "VALIDATED_USERNAME_CALLBACK",
	X509_CERTIFICATE_CALLBACK: "X509_CERTIFICATE_CALLBACK"
}

function isStringPresent(value) {
    return value;
}

function getString(value) {
    return value || '';
}

function isArrayPresent(value) {
    return value;
}

function getArray(value) {
    return value ? JSON.parse(value) : [];
}

function isObjectPresent(value) {
    return value;
}

function getObject(value) {
    return value ? JSON.parse(value) : {};
}

function isIntPresent(value) {
    return value;
}

function getInt(value) {
    return value ? parseInt(value) : 0;
}

function isDoublePresent(value) {
    return value;
}

function getDouble(value) {
    return value ? parseFloat(value) : 0.0;
}

function isBooleanPresent(value) {
    return value;
}

function getBoolean(value) {
    return value ? value.toLowerCase() === 'true' : false;
}

function setProperty(value) {
    if (properties.sharedProperty) nodeState.putShared(properties.sharedProperty, value);
    if (properties.transientProperty) nodeState.putTransient(properties.transientProperty, value);
    if (properties.objectSharedProperty) {
        var attributes = {};
        attributes[properties.objectSharedProperty] = value;
        nodeState.mergeShared({
            objectAttributes: attributes
        });
    }
    if (properties.objectTransientProperty) {
        var attributes = {};
        attributes[properties.objectTransientProperty] = value;
        nodeState.mergeTransient({
            objectAttributes: attributes
        });
    }
}

function booleanAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getBoolean(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required);
    }
}

function choiceCallback() {
    var prompt = getString(properties.options.prompt);
    var choices = getArray(properties.options.choices);
    var defaultChoice = getInt(properties.options.defaultChoice);
    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);
    callbacksBuilder.choiceCallback(prompt, choices, defaultChoice, multipleSelectionsAllowed);
}

function confirmationCallback() {
    var prompt = getString(properties.options.prompt);
    var messageType = getInt(properties.options.messageType);
    var options = getArray(properties.options.options);
    var optionType = getInt(properties.options.optionType);
    var defaultOption = getInt(properties.options.defaultOption);
    if (isStringPresent(properties.options.prompt)) {
        if (isIntPresent(properties.options.optionType)) {
            callbacksBuilder.confirmationCallback(prompt, messageType, optionType, defaultOption);
        } else {
            callbacksBuilder.confirmationCallback(prompt, messageType, options, defaultOption);
        }
    } else {
        if (isIntPresent(properties.options.optionType)) {
            callbacksBuilder.confirmationCallback(messageType, optionType, defaultOption);
        } else {
            callbacksBuilder.confirmationCallback(messageType, options, defaultOption);
        }
    }
}

function consentMappingCallback() {
    var config = getObject(properties.options.config);
    var message = getString(properties.options.message);
    var isRequired = getBoolean(properties.options.isRequired);
    var name = getString(properties.options.name);
    var displayName = getString(properties.options.displayName);
    var icon = getString(properties.options.icon);
    var accessLevel = getString(properties.options.accessLevel);
    var titles = getArray(properties.options.titles);
    if (isObjectPresent(properties.options.prompt)) {
        callbacksBuilder.consentMappingCallback(config, message, isRequired);
    } else {
        callbacksBuilder.consentMappingCallback(name, displayName, icon, accessLevel, titles, message, isRequired);
    }
}

function deviceProfileCallback() {
    var metadata = getBoolean(properties.options.metadata);
    var location = getBoolean(properties.options.location);
    var message = getString(properties.options.message);
    callbacksBuilder.deviceProfileCallback(metadata, location, message);
}

function hiddenValueCallback() {
    var id = getString(properties.options.id);
    var value = getString(properties.options.value);
    callbacksBuilder.hiddenValueCallback(id, value);
}

function httpCallback() {
    var authorizationHeader = getString(properties.options.authorizationHeader);
    var negotiationHeader = getString(properties.options.negotiationHeader);
    var authRHeader = getString(properties.options.authRHeader);
    var negoName = getString(properties.options.negoName);
    var negoValue = getString(properties.options.negoValue);
    if (isStringPresent(properties.options.authorizationHeader) || isStringPresent(properties.options.negotiationHeader)) {
        var errorCode = getString(properties.options.errorCode);
        callbacksBuilder.httpCallback(authorizationHeader, negotiationHeader, errorCode);
    } else {
        var errorCode = getInt(properties.options.errorCode);
        callbacksBuilder.httpCallback(authRHeader, negoName, negoValue, errorCode);
    }
}

function idPCallback() {
    var provider = getString(properties.options.provider);
    var clientId = getString(properties.options.clientId);
    var redirectUri = getString(properties.options.redirectUri);
    var scope = getArray(properties.options.scope);
    var nonce = getString(properties.options.nonce);
    var request = getString(properties.options.request);
    var requestUri = getString(properties.options.requestUri);
    var acrValues = getArray(properties.options.acrValues);
    var requestNativeAppForUserInfo = getBoolean(properties.options.requestNativeAppForUserInfo);
    var token = getString(properties.options.token);
    var tokenType = getString(properties.options.tokenType);
    if (isStringPresent(properties.options.token) || isStringPresent(properties.options.tokenType)) {
        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo, token, tokenType);
    } else {
        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo);
    }
}

function kbaCreateCallback() {
    var prompt = getString(properties.options.prompt);
    var predefinedQuestions = getArray(properties.options.predefinedQuestions);
    var allowUserDefinedQuestions = getBoolean(properties.options.allowUserDefinedQuestions);
    callbacksBuilder.kbaCreateCallback(prompt, predefinedQuestions, allowUserDefinedQuestions);
}

function languageCallback() {
    var language = getString(properties.options.language);
    var country = getString(properties.options.country);
    callbacksBuilder.languageCallback(language, country);
}

function metadataCallback() {
    var outputValue = getObject(properties.options.outputValue);
    callbacksBuilder.metadataCallback(outputValue);
}

function nameCallback() {
    var prompt = getString(properties.options.prompt);
    var defaultName = getString(properties.options.defaultName);
    if (isStringPresent(properties.options.defaultName)) {
        callbacksBuilder.nameCallback(prompt, defaultName);
    } else {
        callbacksBuilder.nameCallback(prompt);
    }
}

function numberAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getDouble(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required);
    }
}

function passwordCallback() {
    var prompt = getString(properties.options.prompt);
    var echoOn = getBoolean(properties.options.echoOn);
    callbacksBuilder.passwordCallback(prompt, echoOn);
}

function pollingWaitCallback() {
    var waitTime = getString(properties.options.waitTime);
    var message = getString(properties.options.message);
    callbacksBuilder.pollingWaitCallback(waitTime, message);
}

function redirectCallback() {
    throw new Error('Not Implemented');
}

function scriptTextOutputCallback() {
    var message = getString(properties.options.message);
    callbacksBuilder.scriptTextOutputCallback(message);
}

function selectIdPCallback() {
    var providers = getObject(properties.options.providers);
    callbacksBuilder.selectIdPCallback(providers);
}

function stringAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getString(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required);
    }
}

function suspendedTextOutputCallback() {
    var messageType = getInt(properties.options.messageType);
    var message = getString(properties.options.message);
    callbacksBuilder.suspendedTextOutputCallback(messageType, message);
}

function termsAndConditionsCallback() {
    var version = getString(properties.options.version);
    var terms = getString(properties.options.terms);
    var createDate = getString(properties.options.createDate);
    callbacksBuilder.termsAndConditionsCallback(version, terms, createDate);
}

function textInputCallback() {
    var prompt = getString(properties.options.prompt);
    var defaultText = getString(properties.options.defaultText);
    if (isStringPresent(properties.options.defaultText)) {
        callbacksBuilder.textInputCallback(prompt, defaultText);
    } else {
        callbacksBuilder.textInputCallback(prompt);
    }
}

function textOutputCallback() {
    var messageType = getString(properties.options.messageType);
    var message = getString(properties.options.message);
    callbacksBuilder.textOutputCallback(messageType, message);
}

function validatedPasswordCallback() {
    var prompt = getString(properties.options.prompt);
    var echoOn = getBoolean(properties.options.echoOn);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isArrayPresent(properties.options.failedPolicies)) {
        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly, failedPolicies);
    } else {
        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly);
    }
}

function validatedUsernameCallback() {
    var prompt = getString(properties.options.prompt);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isArrayPresent(properties.options.failedPolicies)) {
        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly, failedPolicies);
    } else {
        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly);
    }
}

function x509CertificateCallback() {
    throw new Error('Not Implemented');
}

function getBooleanAttributeInputCallback() {
    setProperty(callbacks.getBooleanAttributeInputCallbacks().get(0));
}

function getChoiceCallback() {
    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);
    var selections = callbacks.getChoiceCallbacks().get(0);
    setProperty(multipleSelectionsAllowed ? selections : selections[0]);
}

function getConfirmationCallback() {
    setProperty(callbacks.getConfirmationCallbacks().get(0));
}

function getConsentMappingCallback() {
    setProperty(callbacks.getConsentMappingCallbacks().get(0));
}

function getDeviceProfileCallback() {
    setProperty(callbacks.getDeviceProfileCallbacks().get(0));
}

function getHiddenValueCallback() {
    var id = getString(properties.options.id);
    setProperty(callbacks.getHiddenValueCallbacks().get(id));
}

function getHttpCallback() {
    setProperty(callbacks.getHttpCallbacks().get(0));
}

function getIdPCallback() {
    setProperty(callbacks.getIdpCallbacks().get(0));
}

function getKbaCreateCallback() {
    setProperty(callbacks.getKbaCreateCallbacks().get(0));
}

function getLanguageCallback() {
    setProperty(callbacks.getLanguageCallbacks().get(0));
}

function getNameCallback() {
    setProperty(callbacks.getNameCallbacks().get(0));
}

function getNumberAttributeInputCallback() {
    setProperty(callbacks.getNumberAttributeInputCallbacks().get(0));
}

function getPasswordCallback() {
    setProperty(callbacks.getPasswordCallbacks().get(0));
}

function getSelectIdPCallback() {
    setProperty(callbacks.getSelectIdPCallbacks().get(0));
}

function getStringAttributeInputCallback() {
    setProperty(callbacks.getStringAttributeInputCallbacks().get(0));
}

function getTermsAndConditionsCallback() {
    setProperty(callbacks.getTermsAndConditionsCallbacks().get(0));
}

function getTextInputCallback() {
    setProperty(callbacks.getTextInputCallbacks().get(0));
}

function getValidatedPasswordCallback() {
    setProperty(callbacks.getValidatedPasswordCallbacks().get(0));
}

function getValidatedUsernameCallback() {
    setProperty(callbacks.getValidatedUsernameCallbacks().get(0));
}

function getX509CertificateCallback() {
    setProperty(callbacks.getX509CertificateCallbacks().get(0));
}

function main() {
    if (!callbacks.isEmpty()) {
        switch (properties.callback) {
            case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: getBooleanAttributeInputCallback(); break;
            case CALLBACKS.CHOICE_CALLBACK: getChoiceCallback(); break;
            case CALLBACKS.CONFIRMATION_CALLBACK: getConfirmationCallback(); break;
            case CALLBACKS.CONSENT_MAPPING_CALLBACK: getConsentMappingCallback(); break;
            case CALLBACKS.DEVICE_PROFILE_CALLBACK: getDeviceProfileCallback(); break;
            case CALLBACKS.HIDDEN_VALUE_CALLBACK: getHiddenValueCallback(); break;
            case CALLBACKS.HTTP_CALLBACK: getHttpCallback(); break;
            case CALLBACKS.IDP_CALLBACK: getIdPCallback(); break;
            case CALLBACKS.KBA_CREATE_CALLBACK: getKbaCreateCallback(); break;
            case CALLBACKS.LANGUAGE_CALLBACK: getLanguageCallback(); break;
            case CALLBACKS.NAME_CALLBACK: getNameCallback(); break;
            case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: getNumberAttributeInputCallback(); break;
            case CALLBACKS.PASSWORD_CALLBACK: getPasswordCallback(); break;
            case CALLBACKS.SELECT_IDP_CALLBACK: getSelectIdPCallback(); break;
            case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: getStringAttributeInputCallback(); break;
            case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: getTermsAndConditionsCallback(); break;
            case CALLBACKS.TEXT_INPUT_CALLBACK: getTextInputCallback(); break;
            case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: getValidatedPasswordCallback(); break;
            case CALLBACKS.VALIDATED_USERNAME_CALLBACK: getValidatedUsernameCallback(); break;
            case CALLBACKS.X509_CERTIFICATE_CALLBACK: getX509CertificateCallback(); break;
            default: break;
        }
        action.goTo(SCRIPT_OUTCOMES.OUTCOME);
        return;
    }

    switch (properties.callback) {
        case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: booleanAttributeInputCallback(); break;
        case CALLBACKS.CHOICE_CALLBACK: choiceCallback(); break;
        case CALLBACKS.CONFIRMATION_CALLBACK: confirmationCallback(); break;
        case CALLBACKS.CONSENT_MAPPING_CALLBACK: consentMappingCallback(); break;
        case CALLBACKS.DEVICE_PROFILE_CALLBACK: deviceProfileCallback(); break;
        case CALLBACKS.HIDDEN_VALUE_CALLBACK: hiddenValueCallback(); break;
        case CALLBACKS.HTTP_CALLBACK: httpCallback(); break;
        case CALLBACKS.IDP_CALLBACK: idPCallback(); break;
        case CALLBACKS.KBA_CREATE_CALLBACK: kbaCreateCallback(); break;
        case CALLBACKS.LANGUAGE_CALLBACK: languageCallback(); break;
        case CALLBACKS.METADATA_CALLBACK: metadataCallback(); break;
        case CALLBACKS.NAME_CALLBACK: nameCallback(); break;
        case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: numberAttributeInputCallback(); break;
        case CALLBACKS.PASSWORD_CALLBACK: passwordCallback(); break;
        case CALLBACKS.POLLING_WAIT_CALLBACK: pollingWaitCallback(); break;
        case CALLBACKS.REDIRECT_CALLBACK: redirectCallback(); break;
        case CALLBACKS.SCRIPT_TEXT_OUTPUT_CALLBACK: scriptTextOutputCallback(); break;
        case CALLBACKS.SELECT_IDP_CALLBACK: selectIdPCallback(); break;
        case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: stringAttributeInputCallback(); break;
        case CALLBACKS.SUSPENDED_TEXT_OUTPUT_CALLBACK: suspendedTextOutputCallback(); break;
        case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: termsAndConditionsCallback(); break;
        case CALLBACKS.TEXT_INPUT_CALLBACK: textInputCallback(); break;
        case CALLBACKS.TEXT_OUTPUT_CALLBACK: textOutputCallback(); break;
        case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: validatedPasswordCallback(); break;
        case CALLBACKS.VALIDATED_USERNAME_CALLBACK: validatedUsernameCallback(); break;
        case CALLBACKS.X509_CERTIFICATE_CALLBACK: x509CertificateCallback(); break;
        default: throw new Error('Unknown Callback'); // Should never reach this case
    }
}

main();
",
      "serviceName": "ef81b1a52c914710b3388caebfe7233a",
      "tags": [
        "callback",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4: customNodeExportDir4/Display-State.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "8ab9f1aad4b4460a9c45d15fb148e221-1": {
      "_id": "8ab9f1aad4b4460a9c45d15fb148e221-1",
      "description": "Debug node that displays the shared and transient state of the journey for debugging purposes.",
      "displayName": "Display State",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "displayFormat": {
          "defaultValue": "TABLE",
          "description": "The format in which to display the states.",
          "multivalued": false,
          "options": {
            "JSON": "Raw JSON",
            "TABLE": "HTML Table",
          },
          "required": true,
          "title": "Display Format",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
  OUTCOME: "outcome"
};

function main() {
    if (!callbacks.isEmpty()) {
        action.goTo(SCRIPT_OUTCOMES.OUTCOME);
        return;
    }
    var keySet = nodeState.keys(); // Java Set<String>
    var keys = Array.from(keySet); // Make it into JavaScript array
    debugState = {};
    for (var i in keys) {
        var k = new String(keys[i]);
        var item = nodeState.get(k);
        if (typeof item === "object") {
            debugState[k] = nodeState.getObject(k);
        } else {
            debugState[k] = nodeState.get(k);
        }
    }
    if (properties.displayFormat === "JSON") {
        callbacksBuilder.textOutputCallback(0, \`<pre style="text-align: left;">\${JSON.stringify(debugState, null, 2)}</pre>\`);
        return;
    }
    callbacksBuilder.textOutputCallback(0, \`<table><tr><td style="border: 1px solid black;">Key</td><td style="border: 1px solid black;">Value</td></tr>\${Array.from(Object.keys(debugState).map(k => \`<tr><td style="border: 1px solid black;"><pre style="text-align: left;">\${k}</pre></td><td style="border: 1px solid black;"><pre style="text-align: left;">\${debugState[k]}</pre></td></tr>\`))}</table>\`);
}

main();
",
      "serviceName": "8ab9f1aad4b4460a9c45d15fb148e221",
      "tags": [
        "debug",
        "testing",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4: customNodeExportDir4/Generate-JWT.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "e5ad0110c8ee4dafaae983003cd05d4a-1": {
      "_id": "e5ad0110c8ee4dafaae983003cd05d4a-1",
      "description": "Generate a signed JWT using the HMAC SHA-256 algorithm.",
      "displayName": "Generate JWT",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {
        "audience": {
          "description": "The audience (aud) claim",
          "multivalued": false,
          "required": true,
          "title": "Audience",
          "type": "STRING",
        },
        "issuer": {
          "description": "The issuer (iss) claim",
          "multivalued": false,
          "required": true,
          "title": "Issuer",
          "type": "STRING",
        },
        "signingkey": {
          "defaultValue": "esv.signing.key",
          "description": "The secret label for the HMAC signing key",
          "multivalued": false,
          "required": true,
          "title": "HMAC Signing Key",
          "type": "STRING",
        },
        "validity": {
          "defaultValue": 5,
          "description": "",
          "multivalued": false,
          "required": true,
          "title": "Validity (minutes)",
          "type": "NUMBER",
        },
      },
      "script": "var aud = properties.audience;
var iss = properties.issuer;
var validity = properties.validity;
var esv = properties.signingkey;

var signingkey = systemEnv.getProperty(esv);

var username = nodeState.get("username");

var data = {
  jwtType:"SIGNED",
  jwsAlgorithm: "HS256",
  issuer: iss,
  subject: username,
  audience: aud,
  type: "JWT",
  validityMinutes: validity,
  signingKey: signingkey
};

var jwt = jwtAssertion.generateJwt(data);

if (jwt !== null && jwt.length > 0) {
  nodeState.putShared("assertionJwt" , jwt);
  action.goTo("True");
} else {
  action.goTo("False");
}",
      "serviceName": "e5ad0110c8ee4dafaae983003cd05d4a",
      "tags": [
        "Utilities",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4: customNodeExportDir4/Has-Session.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "c605506774a848f7877b4d17a453bd39-1": {
      "_id": "c605506774a848f7877b4d17a453bd39-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "var SCRIPT_OUTCOMES = {
    TRUE: 'True',
    FALSE: 'False'
}

function main() {
    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);
}

main();
",
      "serviceName": "c605506774a848f7877b4d17a453bd39",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4: customNodeExportDir4/Has-Session-AM.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "session-1": {
      "_id": "session-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session AM",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "var SCRIPT_OUTCOMES = {
    TRUE: 'True',
    FALSE: 'False'
}

function main() {
    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);
}

main();
",
      "serviceName": "session",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -AND customNodeExportDir4": should export all nodes into separate files with no metadata in the directory customNodeExportDir4: customNodeExportDir4/Vector-ALU.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "c15e2efb3deb4d4ea338c74a6440b69f-1": {
      "_id": "c15e2efb3deb4d4ea338c74a6440b69f-1",
      "description": "Simple ALU that performs basic binary vector math operations. Outputs the result onto the shared state with key "c".",
      "displayName": "Vector ALU",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "c",
      ],
      "properties": {
        "a": {
          "defaultValue": [
            1,
            2,
            3,
          ],
          "description": "Left vector operand",
          "multivalued": true,
          "required": true,
          "title": "A",
          "type": "NUMBER",
        },
        "b": {
          "defaultValue": [
            4,
            5,
            6,
          ],
          "description": "Right vector operand",
          "multivalued": true,
          "required": true,
          "title": "B",
          "type": "NUMBER",
        },
        "operator": {
          "defaultValue": "DOT",
          "description": "The binary operation to perform on the vectors.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "CROSS": "X",
            "DOT": ".",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
    SUCCESS: 'Success'
};

var OPERATORS = {
    ADD: "ADD",
    SUBTRACT: "SUBTRACT",
    DOT: "DOT",
    CROSS: "CROSS"
}

function add(a, b) {
    return a.map((v, i) => v + b[i]);
}

function subtract(a, b) {
    return a.map((v, i) => v - b[i]);
}

function dot(a, b) {
    return a.reduce((sum, v, i) => sum + v * b[i], 0);
}

function cross(a, b) {
    return [
        a[1] * b[2] - a[2] * b[1],
        a[2] * b[0] - a[0] * b[2],
        a[0] * b[1] - a[1] * b[0]
    ];
}

function main() {
    if (properties.a.length !== properties.b.length) throw new Error("Vectors not the same dimension.");
    switch (properties.operator) {
        case OPERATORS.ADD:
            nodeState.putShared("c", add(properties.a, properties.b));
            break;
        case OPERATORS.SUBTRACT:
            nodeState.putShared("c", subtract(properties.a, properties.b));
            break;
        case OPERATORS.DOT:
            nodeState.putShared("c", dot(properties.a, properties.b));
            break;
        case OPERATORS.CROSS:
            if (properties.a.length !== 3) throw new Error("Vectors not dimension 3 for cross product");
            nodeState.putShared("c", cross(properties.a, properties.b));
            break;
        default: throw new Error("Unknown operator.");
    }
    action.goTo(SCRIPT_OUTCOMES.SUCCESS);
}

main();
",
      "serviceName": "c15e2efb3deb4d4ea338c74a6440b69f",
      "tags": [
        "math",
        "vector",
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -Nxi c605506774a848f7877b4d17a453bd39 -D customNodeExportDir1": should export custom node with service name "c605506774a848f7877b4d17a453bd39" to directory customNodeExportDir1 with no metadata and extracted script 1`] = `0`;

exports[`frodo node export "frodo node export -Nxi c605506774a848f7877b4d17a453bd39 -D customNodeExportDir1": should export custom node with service name "c605506774a848f7877b4d17a453bd39" to directory customNodeExportDir1 with no metadata and extracted script 2`] = `""`;

exports[`frodo node export "frodo node export -Nxi c605506774a848f7877b4d17a453bd39 -D customNodeExportDir1": should export custom node with service name "c605506774a848f7877b4d17a453bd39" to directory customNodeExportDir1 with no metadata and extracted script: customNodeExportDir1/c605506774a848f7877b4d17a453bd39.nodeTypes.json 1`] = `
{
  "nodeTypes": {
    "c605506774a848f7877b4d17a453bd39-1": {
      "_id": "c605506774a848f7877b4d17a453bd39-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "file://c605506774a848f7877b4d17a453bd39.nodeTypes.js",
      "serviceName": "c605506774a848f7877b4d17a453bd39",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -a": should export all custom nodes to a single file 1`] = `0`;

exports[`frodo node export "frodo node export -a": should export all custom nodes to a single file 2`] = `""`;

exports[`frodo node export "frodo node export -a": should export all custom nodes to a single file: allCustomNodes.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "8ab9f1aad4b4460a9c45d15fb148e221-1": {
      "_id": "8ab9f1aad4b4460a9c45d15fb148e221-1",
      "description": "Debug node that displays the shared and transient state of the journey for debugging purposes.",
      "displayName": "Display State",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "displayFormat": {
          "defaultValue": "TABLE",
          "description": "The format in which to display the states.",
          "multivalued": false,
          "options": {
            "JSON": "Raw JSON",
            "TABLE": "HTML Table",
          },
          "required": true,
          "title": "Display Format",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
  OUTCOME: "outcome"
};

function main() {
    if (!callbacks.isEmpty()) {
        action.goTo(SCRIPT_OUTCOMES.OUTCOME);
        return;
    }
    var keySet = nodeState.keys(); // Java Set<String>
    var keys = Array.from(keySet); // Make it into JavaScript array
    debugState = {};
    for (var i in keys) {
        var k = new String(keys[i]);
        var item = nodeState.get(k);
        if (typeof item === "object") {
            debugState[k] = nodeState.getObject(k);
        } else {
            debugState[k] = nodeState.get(k);
        }
    }
    if (properties.displayFormat === "JSON") {
        callbacksBuilder.textOutputCallback(0, \`<pre style="text-align: left;">\${JSON.stringify(debugState, null, 2)}</pre>\`);
        return;
    }
    callbacksBuilder.textOutputCallback(0, \`<table><tr><td style="border: 1px solid black;">Key</td><td style="border: 1px solid black;">Value</td></tr>\${Array.from(Object.keys(debugState).map(k => \`<tr><td style="border: 1px solid black;"><pre style="text-align: left;">\${k}</pre></td><td style="border: 1px solid black;"><pre style="text-align: left;">\${debugState[k]}</pre></td></tr>\`))}</table>\`);
}

main();
",
      "serviceName": "8ab9f1aad4b4460a9c45d15fb148e221",
      "tags": [
        "debug",
        "testing",
      ],
    },
    "c15e2efb3deb4d4ea338c74a6440b69f-1": {
      "_id": "c15e2efb3deb4d4ea338c74a6440b69f-1",
      "description": "Simple ALU that performs basic binary vector math operations. Outputs the result onto the shared state with key "c".",
      "displayName": "Vector ALU",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "c",
      ],
      "properties": {
        "a": {
          "defaultValue": [
            1,
            2,
            3,
          ],
          "description": "Left vector operand",
          "multivalued": true,
          "required": true,
          "title": "A",
          "type": "NUMBER",
        },
        "b": {
          "defaultValue": [
            4,
            5,
            6,
          ],
          "description": "Right vector operand",
          "multivalued": true,
          "required": true,
          "title": "B",
          "type": "NUMBER",
        },
        "operator": {
          "defaultValue": "DOT",
          "description": "The binary operation to perform on the vectors.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "CROSS": "X",
            "DOT": ".",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
    SUCCESS: 'Success'
};

var OPERATORS = {
    ADD: "ADD",
    SUBTRACT: "SUBTRACT",
    DOT: "DOT",
    CROSS: "CROSS"
}

function add(a, b) {
    return a.map((v, i) => v + b[i]);
}

function subtract(a, b) {
    return a.map((v, i) => v - b[i]);
}

function dot(a, b) {
    return a.reduce((sum, v, i) => sum + v * b[i], 0);
}

function cross(a, b) {
    return [
        a[1] * b[2] - a[2] * b[1],
        a[2] * b[0] - a[0] * b[2],
        a[0] * b[1] - a[1] * b[0]
    ];
}

function main() {
    if (properties.a.length !== properties.b.length) throw new Error("Vectors not the same dimension.");
    switch (properties.operator) {
        case OPERATORS.ADD:
            nodeState.putShared("c", add(properties.a, properties.b));
            break;
        case OPERATORS.SUBTRACT:
            nodeState.putShared("c", subtract(properties.a, properties.b));
            break;
        case OPERATORS.DOT:
            nodeState.putShared("c", dot(properties.a, properties.b));
            break;
        case OPERATORS.CROSS:
            if (properties.a.length !== 3) throw new Error("Vectors not dimension 3 for cross product");
            nodeState.putShared("c", cross(properties.a, properties.b));
            break;
        default: throw new Error("Unknown operator.");
    }
    action.goTo(SCRIPT_OUTCOMES.SUCCESS);
}

main();
",
      "serviceName": "c15e2efb3deb4d4ea338c74a6440b69f",
      "tags": [
        "math",
        "vector",
        "utilities",
      ],
    },
    "c605506774a848f7877b4d17a453bd39-1": {
      "_id": "c605506774a848f7877b4d17a453bd39-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "var SCRIPT_OUTCOMES = {
    TRUE: 'True',
    FALSE: 'False'
}

function main() {
    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);
}

main();
",
      "serviceName": "c605506774a848f7877b4d17a453bd39",
      "tags": [
        "utilities",
      ],
    },
    "c6063fb2f5dc42dd9772bedc93898bd8-1": {
      "_id": "c6063fb2f5dc42dd9772bedc93898bd8-1",
      "description": "Simple ALU that performs basic binary math operations. Expects an "x" and "y" value on the shared state, and will produce a new "z" value on the shared state as output.",
      "displayName": "ALU",
      "errorOutcome": true,
      "inputs": [
        "x",
        "y",
      ],
      "outcomes": [
        "Success",
      ],
      "outputs": [
        "z",
      ],
      "properties": {
        "operator": {
          "defaultValue": "ADD",
          "description": "The operation to perform.",
          "multivalued": false,
          "options": {
            "ADD": "+",
            "DIVIDE": "/",
            "MULTIPLY": "*",
            "SUBTRACT": "-",
          },
          "required": true,
          "title": "Operator",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
    SUCCESS: 'Success'
};

var OPERATORS = {
    ADD: "ADD",
    SUBTRACT: "SUBTRACT",
    MULTIPLY: "MULTIPLY",
    DIVIDE: "DIVIDE"
}

function main() {
    var a = Number(properties.a);
    var b = Number(properties.b);
    switch (properties.operator) {
        case OPERATORS.ADD:
            nodeState.putShared("z", a + b);
            break;
        case OPERATORS.SUBTRACT:
            nodeState.putShared("z", a - b);
            break;
        case OPERATORS.MULTIPLY:
            nodeState.putShared("z", a * b);
            break;
        case OPERATORS.DIVIDE:
            if (b == 0) throw new Error("Cannot divide by 0");
            nodeState.putShared("z", a / b);
            break;
        default: throw new Error("Unknown operator.");
    }
    action.goTo(SCRIPT_OUTCOMES.SUCCESS);
}

main();
",
      "serviceName": "c6063fb2f5dc42dd9772bedc93898bd8",
      "tags": [
        "math",
        "utilities",
      ],
    },
    "e5ad0110c8ee4dafaae983003cd05d4a-1": {
      "_id": "e5ad0110c8ee4dafaae983003cd05d4a-1",
      "description": "Generate a signed JWT using the HMAC SHA-256 algorithm.",
      "displayName": "Generate JWT",
      "errorOutcome": true,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {
        "audience": {
          "description": "The audience (aud) claim",
          "multivalued": false,
          "required": true,
          "title": "Audience",
          "type": "STRING",
        },
        "issuer": {
          "description": "The issuer (iss) claim",
          "multivalued": false,
          "required": true,
          "title": "Issuer",
          "type": "STRING",
        },
        "signingkey": {
          "defaultValue": "esv.signing.key",
          "description": "The secret label for the HMAC signing key",
          "multivalued": false,
          "required": true,
          "title": "HMAC Signing Key",
          "type": "STRING",
        },
        "validity": {
          "defaultValue": 5,
          "description": "",
          "multivalued": false,
          "required": true,
          "title": "Validity (minutes)",
          "type": "NUMBER",
        },
      },
      "script": "var aud = properties.audience;
var iss = properties.issuer;
var validity = properties.validity;
var esv = properties.signingkey;

var signingkey = systemEnv.getProperty(esv);

var username = nodeState.get("username");

var data = {
  jwtType:"SIGNED",
  jwsAlgorithm: "HS256",
  issuer: iss,
  subject: username,
  audience: aud,
  type: "JWT",
  validityMinutes: validity,
  signingKey: signingkey
};

var jwt = jwtAssertion.generateJwt(data);

if (jwt !== null && jwt.length > 0) {
  nodeState.putShared("assertionJwt" , jwt);
  action.goTo("True");
} else {
  action.goTo("False");
}",
      "serviceName": "e5ad0110c8ee4dafaae983003cd05d4a",
      "tags": [
        "Utilities",
        "utilities",
      ],
    },
    "ef81b1a52c914710b3388caebfe7233a-1": {
      "_id": "ef81b1a52c914710b3388caebfe7233a-1",
      "description": "Displays custom callback to the page",
      "displayName": "Display Callback",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "callback": {
          "description": "The callback to display",
          "multivalued": false,
          "options": {
            "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK": "booleanAttributeInputCallback",
            "CHOICE_CALLBACK": "choiceCallback",
            "CONFIRMATION_CALLBACK": "confirmationCallback",
            "CONSENT_MAPPING_CALLBACK": "consentMappingCallback",
            "DEVICE_PROFILE_CALLBACK": "deviceProfileCallback",
            "HIDDEN_VALUE_CALLBACK": "hiddenValueCallback",
            "HTTP_CALLBACK": "httpCallback",
            "IDP_CALLBACK": "idPCallback",
            "KBA_CREATE_CALLBACK": "kbaCreateCallback",
            "LANGUAGE_CALLBACK": "languageCallback",
            "METADATA_CALLBACK": "metadataCallback",
            "NAME_CALLBACK": "nameCallback",
            "NUMBER_ATTRIBUTE_INPUT_CALLBACK": "numberAttributeInputCallback",
            "PASSWORD_CALLBACK": "passwordCallback",
            "POLLING_WAIT_CALLBACK": "pollingWaitCallback",
            "REDIRECT_CALLBACK": "redirectCallback",
            "SCRIPT_TEXT_OUTPUT_CALLBACK": "scriptTextOutputCallback",
            "SELECT_IDP_CALLBACK": "selectIdPCallback",
            "STRING_ATTRIBUTE_INPUT_CALLBACK": "stringAttributeInputCallback",
            "SUSPENDED_TEXT_OUTPUT_CALLBACK": "suspendedTextOutputCallback",
            "TERMS_AND_CONDITIONS_CALLBACK": "termsAndConditionsCallback",
            "TEXT_INPUT_CALLBACK": "textInputCallback",
            "TEXT_OUTPUT_CALLBACK": "textOutputCallback",
            "VALIDATED_PASSWORD_CALLBACK": "validatedPasswordCallback",
            "VALIDATED_USERNAME_CALLBACK": "validatedUsernameCallback",
            "X509_CERTIFICATE_CALLBACK": "x509CertificateCallback",
          },
          "required": true,
          "title": "Callback",
          "type": "STRING",
        },
        "objectSharedProperty": {
          "description": "The objectAttributes property on the shared state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Shared Property",
          "type": "STRING",
        },
        "objectTransientProperty": {
          "description": "The objectAttributes property on the transient state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Transient Property",
          "type": "STRING",
        },
        "options": {
          "description": "The options containing the parameters for the callback (see documentation for possible parameters: https://docs.pingidentity.com/pingoneaic/latest/am-scripting/scripting-api-node.html#scripting-api-node-callbacks). 

For example, for textOutputCallback, the options could be: { messageType: 0, message: "Hello World!" }. 

Note that for required parameters that are not specified in the options will use default values based on the type of the parameter ("" for Strings, [] for Arrays, {} for Objects, 0 for Ints, 0.0 for Doubles, and false for Booleans).",
          "multivalued": false,
          "required": true,
          "title": "Options",
          "type": "OBJECT",
        },
        "sharedProperty": {
          "description": "The shared state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Shared State Property",
          "type": "STRING",
        },
        "transientProperty": {
          "description": "The transient state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Transient State Property",
          "type": "STRING",
        },
      },
      "script": "var SCRIPT_OUTCOMES = {
    OUTCOME: 'outcome'
};

var CALLBACKS = {
	BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK",
	CHOICE_CALLBACK: "CHOICE_CALLBACK",
	CONFIRMATION_CALLBACK: "CONFIRMATION_CALLBACK",
	CONSENT_MAPPING_CALLBACK: "CONSENT_MAPPING_CALLBACK",
	DEVICE_PROFILE_CALLBACK: "DEVICE_PROFILE_CALLBACK",
	HIDDEN_VALUE_CALLBACK: "HIDDEN_VALUE_CALLBACK",
	HTTP_CALLBACK: "HTTP_CALLBACK",
	IDP_CALLBACK: "IDP_CALLBACK",
	KBA_CREATE_CALLBACK: "KBA_CREATE_CALLBACK",
	LANGUAGE_CALLBACK: "LANGUAGE_CALLBACK",
	METADATA_CALLBACK: "METADATA_CALLBACK",
	NAME_CALLBACK: "NAME_CALLBACK",
	NUMBER_ATTRIBUTE_INPUT_CALLBACK: "NUMBER_ATTRIBUTE_INPUT_CALLBACK",
	PASSWORD_CALLBACK: "PASSWORD_CALLBACK",
	POLLING_WAIT_CALLBACK: "POLLING_WAIT_CALLBACK",
    REDIRECT_CALLBACK: "REDIRECT_CALLBACK",
	SCRIPT_TEXT_OUTPUT_CALLBACK: "SCRIPT_TEXT_OUTPUT_CALLBACK",
	SELECT_IDP_CALLBACK: "SELECT_IDP_CALLBACK",
	STRING_ATTRIBUTE_INPUT_CALLBACK: "STRING_ATTRIBUTE_INPUT_CALLBACK",
	SUSPENDED_TEXT_OUTPUT_CALLBACK: "SUSPENDED_TEXT_OUTPUT_CALLBACK",
	TERMS_AND_CONDITIONS_CALLBACK: "TERMS_AND_CONDITIONS_CALLBACK",
	TEXT_INPUT_CALLBACK: "TEXT_INPUT_CALLBACK",
	TEXT_OUTPUT_CALLBACK: "TEXT_OUTPUT_CALLBACK",
	VALIDATED_PASSWORD_CALLBACK: "VALIDATED_PASSWORD_CALLBACK",
	VALIDATED_USERNAME_CALLBACK: "VALIDATED_USERNAME_CALLBACK",
	X509_CERTIFICATE_CALLBACK: "X509_CERTIFICATE_CALLBACK"
}

function isStringPresent(value) {
    return value;
}

function getString(value) {
    return value || '';
}

function isArrayPresent(value) {
    return value;
}

function getArray(value) {
    return value ? JSON.parse(value) : [];
}

function isObjectPresent(value) {
    return value;
}

function getObject(value) {
    return value ? JSON.parse(value) : {};
}

function isIntPresent(value) {
    return value;
}

function getInt(value) {
    return value ? parseInt(value) : 0;
}

function isDoublePresent(value) {
    return value;
}

function getDouble(value) {
    return value ? parseFloat(value) : 0.0;
}

function isBooleanPresent(value) {
    return value;
}

function getBoolean(value) {
    return value ? value.toLowerCase() === 'true' : false;
}

function setProperty(value) {
    if (properties.sharedProperty) nodeState.putShared(properties.sharedProperty, value);
    if (properties.transientProperty) nodeState.putTransient(properties.transientProperty, value);
    if (properties.objectSharedProperty) {
        var attributes = {};
        attributes[properties.objectSharedProperty] = value;
        nodeState.mergeShared({
            objectAttributes: attributes
        });
    }
    if (properties.objectTransientProperty) {
        var attributes = {};
        attributes[properties.objectTransientProperty] = value;
        nodeState.mergeTransient({
            objectAttributes: attributes
        });
    }
}

function booleanAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getBoolean(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.booleanAttributeInputCallback(name, prompt, value, required);
    }
}

function choiceCallback() {
    var prompt = getString(properties.options.prompt);
    var choices = getArray(properties.options.choices);
    var defaultChoice = getInt(properties.options.defaultChoice);
    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);
    callbacksBuilder.choiceCallback(prompt, choices, defaultChoice, multipleSelectionsAllowed);
}

function confirmationCallback() {
    var prompt = getString(properties.options.prompt);
    var messageType = getInt(properties.options.messageType);
    var options = getArray(properties.options.options);
    var optionType = getInt(properties.options.optionType);
    var defaultOption = getInt(properties.options.defaultOption);
    if (isStringPresent(properties.options.prompt)) {
        if (isIntPresent(properties.options.optionType)) {
            callbacksBuilder.confirmationCallback(prompt, messageType, optionType, defaultOption);
        } else {
            callbacksBuilder.confirmationCallback(prompt, messageType, options, defaultOption);
        }
    } else {
        if (isIntPresent(properties.options.optionType)) {
            callbacksBuilder.confirmationCallback(messageType, optionType, defaultOption);
        } else {
            callbacksBuilder.confirmationCallback(messageType, options, defaultOption);
        }
    }
}

function consentMappingCallback() {
    var config = getObject(properties.options.config);
    var message = getString(properties.options.message);
    var isRequired = getBoolean(properties.options.isRequired);
    var name = getString(properties.options.name);
    var displayName = getString(properties.options.displayName);
    var icon = getString(properties.options.icon);
    var accessLevel = getString(properties.options.accessLevel);
    var titles = getArray(properties.options.titles);
    if (isObjectPresent(properties.options.prompt)) {
        callbacksBuilder.consentMappingCallback(config, message, isRequired);
    } else {
        callbacksBuilder.consentMappingCallback(name, displayName, icon, accessLevel, titles, message, isRequired);
    }
}

function deviceProfileCallback() {
    var metadata = getBoolean(properties.options.metadata);
    var location = getBoolean(properties.options.location);
    var message = getString(properties.options.message);
    callbacksBuilder.deviceProfileCallback(metadata, location, message);
}

function hiddenValueCallback() {
    var id = getString(properties.options.id);
    var value = getString(properties.options.value);
    callbacksBuilder.hiddenValueCallback(id, value);
}

function httpCallback() {
    var authorizationHeader = getString(properties.options.authorizationHeader);
    var negotiationHeader = getString(properties.options.negotiationHeader);
    var authRHeader = getString(properties.options.authRHeader);
    var negoName = getString(properties.options.negoName);
    var negoValue = getString(properties.options.negoValue);
    if (isStringPresent(properties.options.authorizationHeader) || isStringPresent(properties.options.negotiationHeader)) {
        var errorCode = getString(properties.options.errorCode);
        callbacksBuilder.httpCallback(authorizationHeader, negotiationHeader, errorCode);
    } else {
        var errorCode = getInt(properties.options.errorCode);
        callbacksBuilder.httpCallback(authRHeader, negoName, negoValue, errorCode);
    }
}

function idPCallback() {
    var provider = getString(properties.options.provider);
    var clientId = getString(properties.options.clientId);
    var redirectUri = getString(properties.options.redirectUri);
    var scope = getArray(properties.options.scope);
    var nonce = getString(properties.options.nonce);
    var request = getString(properties.options.request);
    var requestUri = getString(properties.options.requestUri);
    var acrValues = getArray(properties.options.acrValues);
    var requestNativeAppForUserInfo = getBoolean(properties.options.requestNativeAppForUserInfo);
    var token = getString(properties.options.token);
    var tokenType = getString(properties.options.tokenType);
    if (isStringPresent(properties.options.token) || isStringPresent(properties.options.tokenType)) {
        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo, token, tokenType);
    } else {
        callbacksBuilder.idPCallback(provider, clientId, redirectUri, scope, nonce, request, requestUri, acrValues, requestNativeAppForUserInfo);
    }
}

function kbaCreateCallback() {
    var prompt = getString(properties.options.prompt);
    var predefinedQuestions = getArray(properties.options.predefinedQuestions);
    var allowUserDefinedQuestions = getBoolean(properties.options.allowUserDefinedQuestions);
    callbacksBuilder.kbaCreateCallback(prompt, predefinedQuestions, allowUserDefinedQuestions);
}

function languageCallback() {
    var language = getString(properties.options.language);
    var country = getString(properties.options.country);
    callbacksBuilder.languageCallback(language, country);
}

function metadataCallback() {
    var outputValue = getObject(properties.options.outputValue);
    callbacksBuilder.metadataCallback(outputValue);
}

function nameCallback() {
    var prompt = getString(properties.options.prompt);
    var defaultName = getString(properties.options.defaultName);
    if (isStringPresent(properties.options.defaultName)) {
        callbacksBuilder.nameCallback(prompt, defaultName);
    } else {
        callbacksBuilder.nameCallback(prompt);
    }
}

function numberAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getDouble(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.numberAttributeInputCallback(name, prompt, value, required);
    }
}

function passwordCallback() {
    var prompt = getString(properties.options.prompt);
    var echoOn = getBoolean(properties.options.echoOn);
    callbacksBuilder.passwordCallback(prompt, echoOn);
}

function pollingWaitCallback() {
    var waitTime = getString(properties.options.waitTime);
    var message = getString(properties.options.message);
    callbacksBuilder.pollingWaitCallback(waitTime, message);
}

function redirectCallback() {
    throw new Error('Not Implemented');
}

function scriptTextOutputCallback() {
    var message = getString(properties.options.message);
    callbacksBuilder.scriptTextOutputCallback(message);
}

function selectIdPCallback() {
    var providers = getObject(properties.options.providers);
    callbacksBuilder.selectIdPCallback(providers);
}

function stringAttributeInputCallback() {
    var name = getString(properties.options.name);
    var prompt = getString(properties.options.prompt);
    var value = getString(properties.options.value);
    var required = getBoolean(properties.options.required);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isBooleanPresent(properties.options.validateOnly) || isObjectPresent(properties.options.policies)) {
        if (isArrayPresent(failedPolicies)) {
            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly, failedPolicies);
        } else {
            callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, policies, validateOnly);
        }
    } else if (isArrayPresent(failedPolicies)) {
        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required, failedPolicies);
    } else {
        callbacksBuilder.stringAttributeInputCallback(name, prompt, value, required);
    }
}

function suspendedTextOutputCallback() {
    var messageType = getInt(properties.options.messageType);
    var message = getString(properties.options.message);
    callbacksBuilder.suspendedTextOutputCallback(messageType, message);
}

function termsAndConditionsCallback() {
    var version = getString(properties.options.version);
    var terms = getString(properties.options.terms);
    var createDate = getString(properties.options.createDate);
    callbacksBuilder.termsAndConditionsCallback(version, terms, createDate);
}

function textInputCallback() {
    var prompt = getString(properties.options.prompt);
    var defaultText = getString(properties.options.defaultText);
    if (isStringPresent(properties.options.defaultText)) {
        callbacksBuilder.textInputCallback(prompt, defaultText);
    } else {
        callbacksBuilder.textInputCallback(prompt);
    }
}

function textOutputCallback() {
    var messageType = getString(properties.options.messageType);
    var message = getString(properties.options.message);
    callbacksBuilder.textOutputCallback(messageType, message);
}

function validatedPasswordCallback() {
    var prompt = getString(properties.options.prompt);
    var echoOn = getBoolean(properties.options.echoOn);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isArrayPresent(properties.options.failedPolicies)) {
        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly, failedPolicies);
    } else {
        callbacksBuilder.validatedPasswordCallback(prompt, echoOn, policies, validateOnly);
    }
}

function validatedUsernameCallback() {
    var prompt = getString(properties.options.prompt);
    var policies = getObject(properties.options.policies);
    var validateOnly = getBoolean(properties.options.validateOnly);
    var failedPolicies = getArray(properties.options.failedPolicies);
    if (isArrayPresent(properties.options.failedPolicies)) {
        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly, failedPolicies);
    } else {
        callbacksBuilder.validatedUsernameCallback(prompt, policies, validateOnly);
    }
}

function x509CertificateCallback() {
    throw new Error('Not Implemented');
}

function getBooleanAttributeInputCallback() {
    setProperty(callbacks.getBooleanAttributeInputCallbacks().get(0));
}

function getChoiceCallback() {
    var multipleSelectionsAllowed = getBoolean(properties.options.multipleSelectionsAllowed);
    var selections = callbacks.getChoiceCallbacks().get(0);
    setProperty(multipleSelectionsAllowed ? selections : selections[0]);
}

function getConfirmationCallback() {
    setProperty(callbacks.getConfirmationCallbacks().get(0));
}

function getConsentMappingCallback() {
    setProperty(callbacks.getConsentMappingCallbacks().get(0));
}

function getDeviceProfileCallback() {
    setProperty(callbacks.getDeviceProfileCallbacks().get(0));
}

function getHiddenValueCallback() {
    var id = getString(properties.options.id);
    setProperty(callbacks.getHiddenValueCallbacks().get(id));
}

function getHttpCallback() {
    setProperty(callbacks.getHttpCallbacks().get(0));
}

function getIdPCallback() {
    setProperty(callbacks.getIdpCallbacks().get(0));
}

function getKbaCreateCallback() {
    setProperty(callbacks.getKbaCreateCallbacks().get(0));
}

function getLanguageCallback() {
    setProperty(callbacks.getLanguageCallbacks().get(0));
}

function getNameCallback() {
    setProperty(callbacks.getNameCallbacks().get(0));
}

function getNumberAttributeInputCallback() {
    setProperty(callbacks.getNumberAttributeInputCallbacks().get(0));
}

function getPasswordCallback() {
    setProperty(callbacks.getPasswordCallbacks().get(0));
}

function getSelectIdPCallback() {
    setProperty(callbacks.getSelectIdPCallbacks().get(0));
}

function getStringAttributeInputCallback() {
    setProperty(callbacks.getStringAttributeInputCallbacks().get(0));
}

function getTermsAndConditionsCallback() {
    setProperty(callbacks.getTermsAndConditionsCallbacks().get(0));
}

function getTextInputCallback() {
    setProperty(callbacks.getTextInputCallbacks().get(0));
}

function getValidatedPasswordCallback() {
    setProperty(callbacks.getValidatedPasswordCallbacks().get(0));
}

function getValidatedUsernameCallback() {
    setProperty(callbacks.getValidatedUsernameCallbacks().get(0));
}

function getX509CertificateCallback() {
    setProperty(callbacks.getX509CertificateCallbacks().get(0));
}

function main() {
    if (!callbacks.isEmpty()) {
        switch (properties.callback) {
            case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: getBooleanAttributeInputCallback(); break;
            case CALLBACKS.CHOICE_CALLBACK: getChoiceCallback(); break;
            case CALLBACKS.CONFIRMATION_CALLBACK: getConfirmationCallback(); break;
            case CALLBACKS.CONSENT_MAPPING_CALLBACK: getConsentMappingCallback(); break;
            case CALLBACKS.DEVICE_PROFILE_CALLBACK: getDeviceProfileCallback(); break;
            case CALLBACKS.HIDDEN_VALUE_CALLBACK: getHiddenValueCallback(); break;
            case CALLBACKS.HTTP_CALLBACK: getHttpCallback(); break;
            case CALLBACKS.IDP_CALLBACK: getIdPCallback(); break;
            case CALLBACKS.KBA_CREATE_CALLBACK: getKbaCreateCallback(); break;
            case CALLBACKS.LANGUAGE_CALLBACK: getLanguageCallback(); break;
            case CALLBACKS.NAME_CALLBACK: getNameCallback(); break;
            case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: getNumberAttributeInputCallback(); break;
            case CALLBACKS.PASSWORD_CALLBACK: getPasswordCallback(); break;
            case CALLBACKS.SELECT_IDP_CALLBACK: getSelectIdPCallback(); break;
            case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: getStringAttributeInputCallback(); break;
            case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: getTermsAndConditionsCallback(); break;
            case CALLBACKS.TEXT_INPUT_CALLBACK: getTextInputCallback(); break;
            case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: getValidatedPasswordCallback(); break;
            case CALLBACKS.VALIDATED_USERNAME_CALLBACK: getValidatedUsernameCallback(); break;
            case CALLBACKS.X509_CERTIFICATE_CALLBACK: getX509CertificateCallback(); break;
            default: break;
        }
        action.goTo(SCRIPT_OUTCOMES.OUTCOME);
        return;
    }

    switch (properties.callback) {
        case CALLBACKS.BOOLEAN_ATTRIBUTE_INPUT_CALLBACK: booleanAttributeInputCallback(); break;
        case CALLBACKS.CHOICE_CALLBACK: choiceCallback(); break;
        case CALLBACKS.CONFIRMATION_CALLBACK: confirmationCallback(); break;
        case CALLBACKS.CONSENT_MAPPING_CALLBACK: consentMappingCallback(); break;
        case CALLBACKS.DEVICE_PROFILE_CALLBACK: deviceProfileCallback(); break;
        case CALLBACKS.HIDDEN_VALUE_CALLBACK: hiddenValueCallback(); break;
        case CALLBACKS.HTTP_CALLBACK: httpCallback(); break;
        case CALLBACKS.IDP_CALLBACK: idPCallback(); break;
        case CALLBACKS.KBA_CREATE_CALLBACK: kbaCreateCallback(); break;
        case CALLBACKS.LANGUAGE_CALLBACK: languageCallback(); break;
        case CALLBACKS.METADATA_CALLBACK: metadataCallback(); break;
        case CALLBACKS.NAME_CALLBACK: nameCallback(); break;
        case CALLBACKS.NUMBER_ATTRIBUTE_INPUT_CALLBACK: numberAttributeInputCallback(); break;
        case CALLBACKS.PASSWORD_CALLBACK: passwordCallback(); break;
        case CALLBACKS.POLLING_WAIT_CALLBACK: pollingWaitCallback(); break;
        case CALLBACKS.REDIRECT_CALLBACK: redirectCallback(); break;
        case CALLBACKS.SCRIPT_TEXT_OUTPUT_CALLBACK: scriptTextOutputCallback(); break;
        case CALLBACKS.SELECT_IDP_CALLBACK: selectIdPCallback(); break;
        case CALLBACKS.STRING_ATTRIBUTE_INPUT_CALLBACK: stringAttributeInputCallback(); break;
        case CALLBACKS.SUSPENDED_TEXT_OUTPUT_CALLBACK: suspendedTextOutputCallback(); break;
        case CALLBACKS.TERMS_AND_CONDITIONS_CALLBACK: termsAndConditionsCallback(); break;
        case CALLBACKS.TEXT_INPUT_CALLBACK: textInputCallback(); break;
        case CALLBACKS.TEXT_OUTPUT_CALLBACK: textOutputCallback(); break;
        case CALLBACKS.VALIDATED_PASSWORD_CALLBACK: validatedPasswordCallback(); break;
        case CALLBACKS.VALIDATED_USERNAME_CALLBACK: validatedUsernameCallback(); break;
        case CALLBACKS.X509_CERTIFICATE_CALLBACK: x509CertificateCallback(); break;
        default: throw new Error('Unknown Callback'); // Should never reach this case
    }
}

main();
",
      "serviceName": "ef81b1a52c914710b3388caebfe7233a",
      "tags": [
        "callback",
        "utilities",
      ],
    },
    "session-1": {
      "_id": "session-1",
      "description": "Checks if the user has a current session.",
      "displayName": "Has Session AM",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "True",
        "False",
      ],
      "outputs": [],
      "properties": {},
      "script": "var SCRIPT_OUTCOMES = {
    TRUE: 'True',
    FALSE: 'False'
}

function main() {
    action.goTo(typeof existingSession === "undefined" ? SCRIPT_OUTCOMES.FALSE : SCRIPT_OUTCOMES.TRUE);
}

main();
",
      "serviceName": "session",
      "tags": [
        "utilities",
      ],
    },
  },
}
`;

exports[`frodo node export "frodo node export -xn 'Display Callback' -D customNodeExportDir2": should export the custom node with display name "Display Callback" to the directory customNodeExportDir2 with extracted script 1`] = `0`;

exports[`frodo node export "frodo node export -xn 'Display Callback' -D customNodeExportDir2": should export the custom node with display name "Display Callback" to the directory customNodeExportDir2 with extracted script 2`] = `""`;

exports[`frodo node export "frodo node export -xn 'Display Callback' -D customNodeExportDir2": should export the custom node with display name "Display Callback" to the directory customNodeExportDir2 with extracted script: customNodeExportDir2/Display-Callback.nodeTypes.json 1`] = `
{
  "meta": Any<Object>,
  "nodeTypes": {
    "ef81b1a52c914710b3388caebfe7233a-1": {
      "_id": "ef81b1a52c914710b3388caebfe7233a-1",
      "description": "Displays custom callback to the page",
      "displayName": "Display Callback",
      "errorOutcome": false,
      "inputs": [],
      "outcomes": [
        "outcome",
      ],
      "outputs": [],
      "properties": {
        "callback": {
          "description": "The callback to display",
          "multivalued": false,
          "options": {
            "BOOLEAN_ATTRIBUTE_INPUT_CALLBACK": "booleanAttributeInputCallback",
            "CHOICE_CALLBACK": "choiceCallback",
            "CONFIRMATION_CALLBACK": "confirmationCallback",
            "CONSENT_MAPPING_CALLBACK": "consentMappingCallback",
            "DEVICE_PROFILE_CALLBACK": "deviceProfileCallback",
            "HIDDEN_VALUE_CALLBACK": "hiddenValueCallback",
            "HTTP_CALLBACK": "httpCallback",
            "IDP_CALLBACK": "idPCallback",
            "KBA_CREATE_CALLBACK": "kbaCreateCallback",
            "LANGUAGE_CALLBACK": "languageCallback",
            "METADATA_CALLBACK": "metadataCallback",
            "NAME_CALLBACK": "nameCallback",
            "NUMBER_ATTRIBUTE_INPUT_CALLBACK": "numberAttributeInputCallback",
            "PASSWORD_CALLBACK": "passwordCallback",
            "POLLING_WAIT_CALLBACK": "pollingWaitCallback",
            "REDIRECT_CALLBACK": "redirectCallback",
            "SCRIPT_TEXT_OUTPUT_CALLBACK": "scriptTextOutputCallback",
            "SELECT_IDP_CALLBACK": "selectIdPCallback",
            "STRING_ATTRIBUTE_INPUT_CALLBACK": "stringAttributeInputCallback",
            "SUSPENDED_TEXT_OUTPUT_CALLBACK": "suspendedTextOutputCallback",
            "TERMS_AND_CONDITIONS_CALLBACK": "termsAndConditionsCallback",
            "TEXT_INPUT_CALLBACK": "textInputCallback",
            "TEXT_OUTPUT_CALLBACK": "textOutputCallback",
            "VALIDATED_PASSWORD_CALLBACK": "validatedPasswordCallback",
            "VALIDATED_USERNAME_CALLBACK": "validatedUsernameCallback",
            "X509_CERTIFICATE_CALLBACK": "x509CertificateCallback",
          },
          "required": true,
          "title": "Callback",
          "type": "STRING",
        },
        "objectSharedProperty": {
          "description": "The objectAttributes property on the shared state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Shared Property",
          "type": "STRING",
        },
        "objectTransientProperty": {
          "description": "The objectAttributes property on the transient state to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Object Attributes Transient Property",
          "type": "STRING",
        },
        "options": {
          "description": "The options containing the parameters for the callback (see documentation for possible parameters: https://docs.pingidentity.com/pingoneaic/latest/am-scripting/scripting-api-node.html#scripting-api-node-callbacks). 

For example, for textOutputCallback, the options could be: { messageType: 0, message: "Hello World!" }. 

Note that for required parameters that are not specified in the options will use default values based on the type of the parameter ("" for Strings, [] for Arrays, {} for Objects, 0 for Ints, 0.0 for Doubles, and false for Booleans).",
          "multivalued": false,
          "required": true,
          "title": "Options",
          "type": "OBJECT",
        },
        "sharedProperty": {
          "description": "The shared state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Shared State Property",
          "type": "STRING",
        },
        "transientProperty": {
          "description": "The transient state property to put the callback input into (if applicable)",
          "multivalued": false,
          "required": false,
          "title": "Transient State Property",
          "type": "STRING",
        },
      },
      "script": "file://Display-Callback.nodeTypes.js",
      "serviceName": "ef81b1a52c914710b3388caebfe7233a",
      "tags": [
        "callback",
        "utilities",
      ],
    },
  },
}
`;
